"use strict";(globalThis.webpackChunkumroh_manager_hybrid_src=globalThis.webpackChunkumroh_manager_hybrid_src||[]).push([[390],{390:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var r=a(609),l=a(899),s=a(313),n=a(407);const m=(0,n.A)("bed",[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]]),o=(0,n.A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var i=a(893),c=a(471),d=a(697),u=a(708);const g=()=>{const{api:e}=(0,l.g)(),[t,a]=(0,r.useState)([]),[n,g]=(0,r.useState)(""),[p,b]=(0,r.useState)([]),[x,h]=(0,r.useState)(""),[y,f]=(0,r.useState)(null),[E,v]=(0,r.useState)(!1),[k,N]=(0,r.useState)(!1),[w,_]=(0,r.useState)({number:"",type:"Quad",guests:[]});(0,r.useEffect)(()=>{(async()=>{try{const t=await e.get("/packages?status=active");a(t.data||[])}catch(e){console.error("Gagal load paket",e)}})()},[]),(0,r.useEffect)(()=>{if(!n)return b([]),void h("");const e=t.find(e=>e.id==n);e&&e.hotels?b(e.hotels):b([])},[n,t]);const j=async()=>{if(x){v(!0);try{const t=await e.get(`/rooming/${x}`);f(t.data)}catch(e){console.error(e),e.response&&404!==e.response.status&&alert("Gagal memuat data rooming.")}finally{v(!1)}}};return(0,r.useEffect)(()=>{x?j():f(null)},[x]),(0,r.createElement)("div",{className:"p-6 space-y-6 bg-gray-50 min-h-screen"},(0,r.createElement)("div",{className:"bg-white p-4 rounded-xl shadow-sm border flex flex-col md:flex-row justify-between items-start md:items-center gap-4"},(0,r.createElement)("div",null,(0,r.createElement)("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2"},(0,r.createElement)(m,{className:"text-blue-600"})," Rooming List"),(0,r.createElement)("p",{className:"text-gray-500 text-sm"},"Manajemen pembagian kamar hotel jamaah")),(0,r.createElement)("div",{className:"flex items-center gap-2 bg-gray-100 p-1 rounded-lg"},(0,r.createElement)("select",{className:"bg-transparent border-none focus:ring-0 text-sm font-medium text-gray-700 py-2 px-3 cursor-pointer",value:n,onChange:e=>{g(e.target.value),h("")}},(0,r.createElement)("option",{value:""},"-- 1. Pilih Paket --"),t.map(e=>(0,r.createElement)("option",{key:e.id,value:e.id},e.name))),(0,r.createElement)(o,{size:16,className:"text-gray-400"}),(0,r.createElement)("select",{className:"bg-transparent border-none focus:ring-0 text-sm font-medium text-gray-700 py-2 px-3 cursor-pointer",value:x,onChange:e=>h(e.target.value),disabled:!n},(0,r.createElement)("option",{value:""},"-- 2. Pilih Hotel --"),p.map(e=>(0,r.createElement)("option",{key:e.id,value:e.id},e.hotel_name," (",e.city,")"))))),x?E?(0,r.createElement)(s.A,null):y?(0,r.createElement)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6"},(0,r.createElement)("div",{className:"lg:col-span-1 bg-white rounded-xl shadow-sm border flex flex-col h-[calc(100vh-200px)] sticky top-6"},(0,r.createElement)("div",{className:"p-4 border-b bg-gray-50 flex justify-between items-center rounded-t-xl"},(0,r.createElement)("h3",{className:"font-bold text-gray-700 flex items-center gap-2"},(0,r.createElement)(i.A,{size:18})," Belum Dapat Kamar"),(0,r.createElement)("span",{className:"bg-red-100 text-red-600 px-2 py-0.5 rounded-full text-xs font-bold"},y.unassigned.length)),(0,r.createElement)("div",{className:"flex-1 overflow-y-auto p-3 space-y-2"},0===y.unassigned.length&&(0,r.createElement)("div",{className:"text-center py-10 text-gray-400 text-sm italic"},(0,r.createElement)(c.A,{size:32,className:"mx-auto mb-2 text-green-400"}),"Semua jamaah sudah dapat kamar!"),y.unassigned.map(e=>(0,r.createElement)("div",{key:e.booking_id,className:"p-3 border rounded-lg hover:bg-blue-50 cursor-pointer flex justify-between items-center group transition-colors"},(0,r.createElement)("div",null,(0,r.createElement)("p",{className:"font-medium text-sm text-gray-800"},e.full_name),(0,r.createElement)("div",{className:"flex gap-2 mt-1"},(0,r.createElement)("span",{className:"text-[10px] px-1.5 py-0.5 rounded "+("L"===e.gender?"bg-blue-100 text-blue-600":"bg-pink-100 text-pink-600")},"L"===e.gender?"Pria":"Wanita"),(0,r.createElement)("span",{className:"text-[10px] bg-gray-100 text-gray-500 px-1.5 py-0.5 rounded border"},"Req: ",e.selected_room_type))),(0,r.createElement)("button",{onClick:()=>{_(t=>({...t,guests:[e.booking_id]})),N(!0)},className:"opacity-0 group-hover:opacity-100 bg-blue-600 text-white p-1.5 rounded-md shadow hover:bg-blue-700 transition-all",title:"Buat Kamar Baru dengan Jamaah ini"},(0,r.createElement)(d.A,{size:14}))))),(0,r.createElement)("div",{className:"p-4 border-t bg-gray-50 rounded-b-xl"},(0,r.createElement)("button",{onClick:()=>N(!0),className:"w-full bg-blue-600 text-white py-2.5 rounded-lg text-sm font-medium hover:bg-blue-700 flex justify-center items-center gap-2 shadow-sm"},(0,r.createElement)(d.A,{size:16})," Buat Kamar Baru"))),(0,r.createElement)("div",{className:"lg:col-span-2 space-y-4"},(0,r.createElement)("div",{className:"flex justify-between items-center"},(0,r.createElement)("h3",{className:"font-bold text-gray-700"},"Daftar Kamar Terisi (",y.rooms.length,")")),0===y.rooms.length&&(0,r.createElement)("div",{className:"p-12 text-center text-gray-400 bg-white rounded-xl border border-dashed"},"Belum ada kamar yang dibuat untuk hotel ini.",(0,r.createElement)("br",null),'Klik tombol "Buat Kamar Baru" di panel kiri.'),(0,r.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},y.rooms.map(t=>(0,r.createElement)("div",{key:t.id,className:"bg-white border rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow"},(0,r.createElement)("div",{className:"bg-gray-800 text-white p-3 flex justify-between items-center"},(0,r.createElement)("div",null,(0,r.createElement)("h4",{className:"font-bold text-lg"},"Kamar ",t.room_number),(0,r.createElement)("span",{className:"text-xs bg-gray-700 px-2 py-0.5 rounded text-gray-200"},t.room_type," (",t.guests.length," Org)")),(0,r.createElement)("button",{onClick:()=>(async t=>{if(confirm("Hapus kamar ini? Penghuni akan kembali ke status 'Belum Dapat Kamar'."))try{await e.delete(`/rooming/room/${t}`),j()}catch(e){alert("Gagal menghapus kamar")}})(t.id),className:"text-gray-400 hover:text-red-400 p-1 rounded hover:bg-gray-700 transition-colors"},(0,r.createElement)(u.A,{size:18}))),(0,r.createElement)("div",{className:"p-3 space-y-2 bg-white min-h-[100px]"},t.guests.map((e,t)=>(0,r.createElement)("div",{key:e.guest_id,className:"flex items-center gap-3 text-sm border-b border-gray-50 pb-2 last:border-0 last:pb-0"},(0,r.createElement)("span",{className:"text-xs text-gray-400 w-4"},t+1,"."),(0,r.createElement)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white "+("L"===e.gender?"bg-blue-500":"bg-pink-500")},e.gender),(0,r.createElement)("span",{className:"text-gray-700 font-medium"},e.full_name))),0===t.guests.length&&(0,r.createElement)("div",{className:"h-full flex items-center justify-center text-xs text-red-400 bg-red-50 rounded py-4"},"Kamar Kosong"))))))):null:(0,r.createElement)("div",{className:"text-center py-20 bg-white rounded-xl border border-dashed border-gray-300"},(0,r.createElement)(m,{size:48,className:"mx-auto mb-4 text-gray-300"}),(0,r.createElement)("h3",{className:"text-lg font-medium text-gray-500"},"Silakan pilih Paket dan Hotel terlebih dahulu"),(0,r.createElement)("p",{className:"text-sm text-gray-400"},"Data kamar dan jamaah akan muncul di sini.")),k&&y&&(0,r.createElement)("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},(0,r.createElement)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto animate-in fade-in zoom-in duration-200"},(0,r.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,r.createElement)("h2",{className:"text-xl font-bold text-gray-800"},"Setup Kamar Baru"),(0,r.createElement)("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-600"},"âœ•")),(0,r.createElement)("div",{className:"grid grid-cols-2 gap-4 mb-6"},(0,r.createElement)("div",null,(0,r.createElement)("label",{className:"block text-sm font-medium mb-1.5 text-gray-700"},"Nomor Kamar"),(0,r.createElement)("input",{autoFocus:!0,type:"text",className:"w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",placeholder:"Cth: 101, 205",value:w.number,onChange:e=>_({...w,number:e.target.value})})),(0,r.createElement)("div",null,(0,r.createElement)("label",{className:"block text-sm font-medium mb-1.5 text-gray-700"},"Tipe Kamar"),(0,r.createElement)("select",{className:"w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 outline-none",value:w.type,onChange:e=>_({...w,type:e.target.value})},(0,r.createElement)("option",{value:"Quad"},"Quad (Isi 4)"),(0,r.createElement)("option",{value:"Triple"},"Triple (Isi 3)"),(0,r.createElement)("option",{value:"Double"},"Double (Isi 2)")))),(0,r.createElement)("div",{className:"mb-6"},(0,r.createElement)("div",{className:"flex justify-between items-end mb-2"},(0,r.createElement)("label",{className:"block text-sm font-medium text-gray-700"},"Pilih Jamaah (",w.guests.length," terpilih)"),(0,r.createElement)("span",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded"},"Klik nama untuk memilih")),(0,r.createElement)("div",{className:"border border-gray-200 rounded-xl p-3 max-h-60 overflow-y-auto grid grid-cols-1 sm:grid-cols-2 gap-2 bg-gray-50"},0===y.unassigned.length&&(0,r.createElement)("p",{className:"col-span-2 text-center text-gray-400 py-4"},"Tidak ada jamaah tersisa."),y.unassigned.map(e=>{const t=w.guests.includes(e.booking_id);return(0,r.createElement)("div",{key:e.booking_id,onClick:()=>(e=>{const t=w.guests;if(t.includes(e))_({...w,guests:t.filter(t=>t!==e)});else{const a={Quad:4,Triple:3,Double:2};if(t.length>=a[w.type])return void alert(`Maksimal ${a[w.type]} orang untuk tipe kamar ${w.type}`);_({...w,guests:[...t,e]})}})(e.booking_id),className:"p-2.5 rounded-lg cursor-pointer border transition-all flex items-center gap-3 "+(t?"bg-blue-600 border-blue-600 text-white shadow-md transform scale-[1.02]":"bg-white border-gray-200 text-gray-600 hover:border-blue-300")},t?(0,r.createElement)(c.A,{size:18,className:"text-white"}):(0,r.createElement)("div",{className:"w-[18px] h-[18px] rounded-full border border-gray-300"}),(0,r.createElement)("div",{className:"truncate text-sm font-medium"},e.full_name,(0,r.createElement)("span",{className:"ml-1 text-xs opacity-70 font-normal"},"(",e.gender,")")))}))),(0,r.createElement)("div",{className:"flex justify-end gap-3 pt-4 border-t"},(0,r.createElement)("button",{onClick:()=>N(!1),className:"px-5 py-2.5 text-gray-600 hover:bg-gray-100 rounded-lg font-medium transition-colors"},"Batal"),(0,r.createElement)("button",{onClick:async t=>{if(t.preventDefault(),0!==w.guests.length)try{await e.post(`/rooming/${x}`,{room_number:w.number,room_type:w.type,booking_ids:w.guests}),N(!1),_({number:"",type:"Quad",guests:[]}),j()}catch(t){alert("Gagal membuat kamar.")}else alert("Pilih minimal 1 jamaah untuk masuk kamar ini.")},className:"px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium shadow-lg shadow-blue-200 transition-all transform active:scale-95"},"Simpan Kamar")))))}},471:(e,t,a)=>{a.d(t,{A:()=>r});const r=(0,a(407).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},697:(e,t,a)=>{a.d(t,{A:()=>r});const r=(0,a(407).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},708:(e,t,a)=>{a.d(t,{A:()=>r});const r=(0,a(407).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])}}]);
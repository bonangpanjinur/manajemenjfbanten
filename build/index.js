(()=>{"use strict";var e={338:(e,t,a)=>{var l=a(795);t.H=l.createRoot,l.hydrateRoot},795:e=>{e.exports=window.ReactDOM}},t={};function a(l){var n=t[l];if(void 0!==n)return n.exports;var r=t[l]={exports:{}};return e[l](r,r.exports,a),r.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};a.r(l),a.d(l,{x:()=>N,k:()=>k});var n={};a.r(n),a.d(n,{K:()=>_});var r={};a.r(r),a.d(r,{a:()=>F,j:()=>O});var s={};a.r(s),a.d(s,{vv:()=>U,Yq:()=>q,rm:()=>z,KC:()=>B});const c=window.React;var i=a.n(c),m=a(338);const o=window.umh_wp_data||{},d=o.current_user||null,p=o.api_nonce||null,u=o.api_url||"/wp-json/umh/v1",g=(0,c.createContext)(),x=({children:e})=>{const[t,a]=(0,c.useState)(d),l={currentUser:t,setCurrentUser:a,nonce:p,apiUrl:u,adminUrl:o.adminUrl,printUrl:o.printUrl,isWpAdmin:o.is_wp_admin||!1};return(0,c.createElement)(g.Provider,{value:l},e)},y=()=>(0,c.useContext)(g),h=(0,c.createContext)(),E=()=>(0,c.useContext)(h),f=({children:e})=>{const{currentUser:t,apiUrl:a,isWpAdmin:l,nonce:n}=y(),[r,s]=(0,c.useState)({packages:[],jamaah:[],finance:[],hr:[],marketing:[],logs:[],stats:{}}),[i,m]=(0,c.useState)(!0),[o,d]=(0,c.useState)(null),p=(0,c.useCallback)(()=>{const e=new Headers;return e.append("Content-Type","application/json"),l?n?e.append("X-WP-Nonce",n):console.warn("WP Nonce is not available, API calls might fail."):console.warn("Mode non-WP-Admin (headless) belum didukung otentikasinya."),e},[l,n]),u=(0,c.useCallback)(async e=>{const t=p();if(!a){console.error("apiUrl not available from AuthContext."),m(!1);const e="API configuration is missing.";throw d(e),new Error(e)}try{const l="marketing"===e||"hr"===e?e:`${e}s`,n=await fetch(`${a}/${l}`,{method:"GET",headers:t});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch ${e}`)}return await n.json()}catch(t){throw console.error(`Error fetching ${e}:`,t),d(t.message),t}},[p,a]),g=(0,c.useCallback)(async()=>{m(!0),d(null);try{const[e,t,a,l,n,r,c]=await Promise.all([u("package"),u("jamaah"),u("finance"),u("hr"),u("marketing"),u("log"),u("stats")]);s({packages:e,jamaah:t,finance:a,hr:l,marketing:n,logs:r,stats:c})}catch(e){console.error("Failed to load initial data:",e),d("Gagal memuat data. Silakan coba lagi.")}finally{m(!1)}},[u]);(0,c.useEffect)(()=>{t&&a?g():t?a||(m(!1),d("API URL is not defined. Cannot fetch data.")):(m(!1),console.warn("User data not available, waiting..."))},[t,a,g]);const x={data:r,loading:i,error:o,refreshData:g,createOrUpdate:async(e,t)=>{const l=p();if(!a)throw console.error("apiUrl not available from AuthContext."),new Error("API configuration is missing.");const n=t.id,r="marketing"===e||"hr"===e?e:`${e}s`,s=n?`${a}/${r}/${t.id}`:`${a}/${r}`,c=n?"PUT":"POST";try{const a=await fetch(s,{method:c,headers:l,body:JSON.stringify(t)});if(!a.ok){const t=await a.json();throw new Error(t.message||`Failed to ${c} ${e}`)}return await g(),await a.json()}catch(t){throw console.error(`Error ${c} ${e}:`,t),d(t.message),t}},deleteItem:async(e,t)=>{const l=p();if(!a)throw console.error("apiUrl not available from AuthContext."),new Error("API configuration is missing.");const n=`${a}/${"marketing"===e||"hr"===e?e:`${e}s`}/${t}`;try{const t=await fetch(n,{method:"DELETE",headers:l});if(!t.ok){const a=await t.json();throw new Error(a.message||`Failed to delete ${e}`)}return await g(),await t.json()}catch(t){throw console.error(`Error deleting ${e}:`,t),d(t.message),t}},updatePaymentStatus:async(e,t)=>{const l=p();if(!a)throw console.error("apiUrl not available from AuthContext."),new Error("API configuration is missing.");const n=`${a}/jamaah-payments/update-status`;try{const a=await fetch(n,{method:"POST",headers:l,body:JSON.stringify({payment_id:e,status:t})});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to update payment status")}return await g(),await a.json()}catch(e){throw console.error("Error updating payment status:",e),d(e.message),e}},uploadFile:async e=>{const t=p();if(!a)throw console.error("apiUrl not available from AuthContext."),new Error("API configuration is missing.");const l=`${a}/uploads`;t.delete("Content-Type");try{const a=await fetch(l,{method:"POST",headers:t,body:e});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to upload file")}return await a.json()}catch(e){throw console.error("Error uploading file:",e),d(e.message),e}}};return(0,c.createElement)(h.Provider,{value:x},e)};var b={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const w=(e,t)=>{const a=(0,c.forwardRef)(({color:a="currentColor",size:l=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,...m},o)=>{return(0,c.createElement)("svg",{ref:o,...b,width:l,height:l,stroke:a,strokeWidth:r?24*Number(n)/Number(l):n,className:["lucide",`lucide-${d=e,d.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,s].join(" "),...m},[...t.map(([e,t])=>(0,c.createElement)(e,t)),...Array.isArray(i)?i:[i]]);var d});return a.displayName=`${e}`,a},v=w("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),k=()=>(0,c.createElement)("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center rounded-lg z-50 min-h-[200px]"},(0,c.createElement)(v,{size:32,className:"animate-spin text-blue-600"})),N=()=>(0,c.createElement)("div",{className:"fixed inset-0 bg-white flex items-center justify-center z-[9999]"},(0,c.createElement)(v,{size:48,className:"animate-spin text-blue-600"})),_=({message:e})=>(0,c.createElement)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative my-4",role:"alert"},(0,c.createElement)("strong",{className:"font-bold"},"Error: "),(0,c.createElement)("span",{className:"block sm:inline"},e)),C=(...e)=>e.filter(Boolean).join(" "),S=(0,c.forwardRef)(({className:e,variant:t="primary",size:a="md",children:l,...n},r)=>{const s={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-5 py-2.5 text-base",icon:"p-2"};return(0,c.createElement)("button",{ref:r,className:C("inline-flex items-center justify-center gap-2 font-medium rounded-md shadow-sm transition-colors duration-150 focus:outline-none focus:ring-2 focus:ring-offset-2","icon"===t?s.icon:s[a],{primary:"bg-blue-600 text-white hover:bg-blue-700 focus-visible:ring-blue-500",secondary:"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 focus-visible:ring-gray-300",danger:"bg-red-600 text-white hover:bg-red-700 focus-visible:ring-red-500",icon:"text-gray-500 hover:text-gray-700 hover:bg-gray-100 p-2 rounded-full focus-visible:ring-gray-300"}[t],e),...n},l)});S.displayName="Button";const j=(0,c.forwardRef)(({className:e,type:t="text",...a},l)=>(0,c.createElement)("input",{type:t,ref:l,className:C("block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm","placeholder-gray-400","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500","disabled:bg-gray-100 disabled:cursor-not-allowed","text-sm",e),...a}));j.displayName="Input";const M=(0,c.forwardRef)(({className:e,children:t,...a},l)=>(0,c.createElement)("select",{ref:l,className:C("block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500","text-sm",e),...a},t));M.displayName="Select";const T=(0,c.forwardRef)(({className:e,...t},a)=>(0,c.createElement)("textarea",{ref:a,className:C("block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm","placeholder-gray-400","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500","text-sm","min-h-[80px]",e),...t}));T.displayName="Textarea";const P=({className:e,children:t})=>(0,c.createElement)("div",{className:C("mb-4",e)},t),L=({htmlFor:e,children:t,className:a})=>(0,c.createElement)("label",{htmlFor:e,className:C("block text-sm font-medium text-gray-700 mb-1",a)},t),D=(0,c.forwardRef)(({className:e,label:t,...a},l)=>(0,c.createElement)("div",{className:"flex items-center gap-2"},(0,c.createElement)("input",{type:"checkbox",ref:l,id:a.id||a.name,className:C("h-4 w-4 text-blue-600 border-gray-300 rounded","focus:ring-blue-500",e),...a}),t&&(0,c.createElement)(L,{htmlFor:a.id||a.name,className:"mb-0"},t)));D.displayName="Checkbox";const A=w("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),$=(...e)=>e.filter(Boolean).join(" "),F=({title:e,isOpen:t,onClose:a,children:l,footer:n,size:r="3xl"})=>t?(0,c.createElement)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-[1000] overflow-y-auto pt-16",onClick:a},(0,c.createElement)("div",{className:$("bg-white rounded-lg shadow-xl w-full m-auto flex flex-col max-h-[90vh]",{sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","3xl":"max-w-3xl","4xl":"max-w-4xl","5xl":"max-w-5xl"}[r]||"max-w-3xl"),onClick:e=>e.stopPropagation()},(0,c.createElement)("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 sticky top-0 bg-white rounded-t-lg z-10"},(0,c.createElement)("h3",{className:"text-xl font-semibold text-gray-800"},e),(0,c.createElement)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600"},(0,c.createElement)(A,{className:"h-6 w-6"}))),(0,c.createElement)("div",{className:"p-6 overflow-y-auto"},l),n&&(0,c.createElement)("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-200 bg-gray-50 rounded-b-lg sticky bottom-0 z-10"},n))):null,O=({onCancel:e,submitText:t="Simpan",children:a})=>(0,c.createElement)(c.Fragment,null,(0,c.createElement)(S,{onClick:e,variant:"secondary"},"Batal"),(0,c.createElement)(S,{type:"submit",variant:"primary"},t),a),U=e=>("number"!=typeof e&&(e=parseFloat(e)||0),new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e)),q=e=>{if(!e)return"-";try{const t=new Date(e);return isNaN(t.getTime())?"-":t.toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric",timeZone:"UTC"})}catch(t){return e}},z=e=>{if(!e)return"";try{const t=new Date(e);return isNaN(t.getTime())?"":t.toISOString().split("T")[0]}catch(e){return""}},B=e=>{const t=(e||"pending").replace(/_/g," "),a=t.toLowerCase().replace(/ /g,"_").replace(/[^a-z0-9_]/g,"");return(0,c.createElement)("span",{className:`status-badge ${a}`},t)},H=w("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),I=w("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),K=w("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),R=({label:e,value:t,color:a})=>(0,c.createElement)("div",{className:"p-3 bg-gray-50 rounded-lg text-center"},(0,c.createElement)("span",{className:"text-xs font-medium text-gray-500 uppercase"},e),(0,c.createElement)("p",{className:`text-xl font-bold ${a}`},t)),J=({jamaah:e,onClose:t})=>{const{updatePaymentStatus:a,loading:l,error:n}=E(),[r,s]=(0,c.useState)(null),[i,m]=(0,c.useState)(null),o=e?.payments||[],d=o.reduce((e,t)=>"paid"===t.status?e+t.amount:e,0),p=o.reduce((e,t)=>"pending"===t.status?e+t.amount:e,0),u=e?.package_price||0,g=u-d;return(0,c.createElement)(F,{title:`Riwayat Pembayaran: ${e.name}`,onClose:t},(0,c.createElement)("div",{className:"p-6 space-y-4"},n&&(0,c.createElement)(_,{message:n}),r&&(0,c.createElement)(_,{message:r}),(0,c.createElement)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},(0,c.createElement)(R,{label:"Total Tagihan",value:U(u),color:"text-blue-600"}),(0,c.createElement)(R,{label:"Total Lunas",value:U(d),color:"text-green-600"}),(0,c.createElement)(R,{label:"Tertunda",value:U(p),color:"text-yellow-600"}),(0,c.createElement)(R,{label:"Sisa Tagihan",value:U(g),color:g>0?"text-red-600":"text-green-600"})),(0,c.createElement)("div",{className:"space-y-3 max-h-96 overflow-y-auto"},0===o.length?(0,c.createElement)("p",{className:"text-center text-gray-500"},"Belum ada riwayat pembayaran."):o.map(e=>{const t=(e=>{switch(e){case"paid":return{icon:(0,c.createElement)(H,{className:"w-4 h-4 text-green-500"}),text:"Lunas",color:"text-green-600"};case"pending":return{icon:(0,c.createElement)(I,{className:"w-4 h-4 text-yellow-500"}),text:"Pending",color:"text-yellow-600"};case"cancelled":return{icon:(0,c.createElement)(A,{className:"w-4 h-4 text-red-500"}),text:"Dibatalkan",color:"text-red-600"};default:return{icon:(0,c.createElement)(K,{className:"w-4 h-4 text-gray-500"}),text:"Unknown",color:"text-gray-600"}}})(e.status),n=i===e.id;return(0,c.createElement)("div",{key:e.id,className:"p-4 border rounded-lg bg-white shadow-sm flex flex-col sm:flex-row sm:items-center sm:justify-between"},(0,c.createElement)("div",{className:"flex-1 mb-2 sm:mb-0"},(0,c.createElement)("div",{className:"flex items-center"},t.icon,(0,c.createElement)("span",{className:`ml-2 font-semibold ${t.color}`},t.text)),(0,c.createElement)("p",{className:"text-lg font-bold text-gray-800"},U(e.amount)),(0,c.createElement)("p",{className:"text-sm text-gray-500"},"Metode: ",e.payment_method," | Tanggal: ",q(e.payment_date)),e.notes&&(0,c.createElement)("p",{className:"text-xs text-gray-400 mt-1"},"Catatan: ",e.notes)),(0,c.createElement)("div",{className:"w-full sm:w-48"},n?(0,c.createElement)("div",{className:"flex justify-center items-center h-10"},(0,c.createElement)(k,null)):(0,c.createElement)(M,{value:e.status,onChange:t=>(async(e,t)=>{s(null),m(e);try{await a(e,t)}catch(e){s(e.message||"Gagal mengupdate status.")}finally{m(null)}})(e.id,t.target.value),disabled:l},(0,c.createElement)("option",{value:"pending"},"Pending"),(0,c.createElement)("option",{value:"paid"},"Lunas"),(0,c.createElement)("option",{value:"cancelled"},"Dibatalkan"))))}))),(0,c.createElement)(O,null,(0,c.createElement)(S,{variant:"secondary",onClick:t,disabled:l},"Tutup")))},G=w("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),W=w("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),V=w("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Z=w("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),X=w("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),Y=w("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),Q=w("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),ee=w("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),te=w("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),ae=(...e)=>e.filter(Boolean).join(" "),le=({title:e,value:t,icon:a,color:l})=>{const n={primary:"bg-blue-100 text-blue-600",success:"bg-green-100 text-green-600",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-600"};return(0,c.createElement)("div",{className:"bg-white border border-gray-200 rounded-lg p-5 flex items-center gap-4 transition-all duration-200 hover:shadow-lg hover:-translate-y-1"},(0,c.createElement)("div",{className:ae("p-3 rounded-full flex items-center justify-center",n[l]||n.primary)},a),(0,c.createElement)("div",{className:"overflow-hidden"},(0,c.createElement)("p",{className:"text-sm font-medium text-gray-500 truncate"},e),(0,c.createElement)("h3",{className:"text-2xl font-bold text-gray-900 truncate"},t)))},ne=w("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),re=({openModal:e})=>{const{data:t,loading:a,error:l}=E();if(a)return(0,c.createElement)(N,{message:"Memuat dashboard..."});if(l)return(0,c.createElement)(_,{title:"Gagal Memuat",message:l});const{stats:n,jamaah:r,packages:s}=t,i=s.filter(e=>"available"===e.status).reduce((e,t)=>e+(t.available_seats||0),0);return(0,c.createElement)("div",{className:"space-y-6"},(0,c.createElement)("h1",{className:"text-3xl font-bold text-gray-800"},"Dashboard"),(0,c.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},(0,c.createElement)(le,{title:"Total Jamaah Aktif",value:n.total_jamaah||0,icon:(0,c.createElement)(V,{className:"w-8 h-8 text-blue-500"}),color:"blue"}),(0,c.createElement)(le,{title:"Total Paket Tersedia",value:n.available_packages||0,icon:(0,c.createElement)(W,{className:"w-8 h-8 text-green-500"}),color:"green"}),(0,c.createElement)(le,{title:"Sisa Kursi (Total)",value:i,icon:(0,c.createElement)(ne,{className:"w-8 h-8 text-indigo-500"}),color:"indigo"}),(0,c.createElement)(le,{title:"Total Piutang (Pending)",value:U(n.total_pending_payments||0),icon:(0,c.createElement)(Z,{className:"w-8 h-8 text-yellow-500"}),color:"yellow"})),(0,c.createElement)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},(0,c.createElement)("div",{className:"bg-white p-6 rounded-lg shadow"},(0,c.createElement)("h2",{className:"text-xl font-semibold text-gray-700 mb-4"},"Jamaah Baru"),(0,c.createElement)("div",{className:"space-y-3 max-h-64 overflow-y-auto"},r.slice(0,5).map(e=>(0,c.createElement)("div",{key:e.id,className:"flex items-center justify-between p-3 bg-gray-50 rounded-md"},(0,c.createElement)("div",null,(0,c.createElement)("p",{className:"font-medium text-gray-800"},e.name),(0,c.createElement)("p",{className:"text-sm text-gray-500"},e.email)),(0,c.createElement)("span",{className:"text-sm text-gray-600"},e.package_name||"Tanpa Paket"))),0===r.length&&(0,c.createElement)("p",{className:"text-gray-500"},"Belum ada data jamaah."))),(0,c.createElement)("div",{className:"bg-white p-6 rounded-lg shadow"},(0,c.createElement)("h2",{className:"text-xl font-semibold text-gray-700 mb-4"},"Paket Akan Berangkat"),(0,c.createElement)("div",{className:"space-y-3 max-h-64 overflow-y-auto"},s.filter(e=>"available"===e.status).slice(0,5).map(e=>(0,c.createElement)("div",{key:e.id,className:"flex items-center justify-between p-3 bg-gray-50 rounded-md"},(0,c.createElement)("div",null,(0,c.createElement)("p",{className:"font-medium text-gray-800"},e.name),(0,c.createElement)("p",{className:"text-sm text-gray-500"},"Berangkat: ",e.start_date)),(0,c.createElement)("span",{className:"font-medium text-indigo-600"},e.available_seats," / ",e.total_seats," kursi"))),0===s.length&&(0,c.createElement)("p",{className:"text-gray-500"},"Belum ada data paket.")))))},se=w("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ce=w("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),ie=({data:e,onClose:t})=>{const{createOrUpdate:a,loading:l,error:n}=E(),[r,i]=(0,c.useState)(null),[m,o]=(0,c.useState)(!1),d=e||{name:"",description:"",price:"0",duration_days:"9",start_date:"",end_date:"",departure_city:"JKT",total_seats:50,available_seats:50,status:"available",includes_flights:!0,includes_hotels:!0,includes_visa:!0,itinerary:JSON.stringify([{day:"1",title:"",details:""}]),includes:[]},[p,u]=(0,c.useState)({name:d.name,description:d.description,duration_days:d.duration_days,start_date:d.start_date,end_date:d.end_date,departure_city:d.departure_city,total_seats:d.total_seats,available_seats:d.available_seats,status:d.status,includes_flights:d.includes_flights,includes_hotels:d.includes_hotels,includes_visa:d.includes_visa}),[g,x]=(0,c.useState)(U(d.price)),[y,h]=(0,c.useState)(d.itinerary?JSON.parse(d.itinerary):[{day:"1",title:"",details:""}]),[f,b]=(0,c.useState)(d.includes?d.includes.join("\n"):"");(0,c.useEffect)(()=>{n&&i(n)},[n]);const w=e=>{const{name:t,value:a,type:l,checked:n}=e.target;u(e=>({...e,[t]:"checkbox"===l?n:a}))},v=(e,t,a)=>{const l=[...y];l[e][t]=a,h(l)};return(0,c.createElement)("form",{onSubmit:async l=>{l.preventDefault(),i(null),o(!0);const n={...p,price:(0,s.parseCurrency)(g),itinerary:JSON.stringify(y),includes:f.split("\n").filter(e=>""!==e.trim()),duration_days:parseInt(p.duration_days,10)||0,total_seats:parseInt(p.total_seats,10)||0,available_seats:parseInt(p.available_seats,10)||0};e&&e.id&&(n.id=e.id);try{await a("package",n),o(!1),t()}catch(e){o(!1),i(e.message||"Gagal menyimpan paket.")}},className:"space-y-6"},r&&(0,c.createElement)(_,{message:r}),(0,c.createElement)(j,{label:"Nama Paket",name:"name",value:p.name,onChange:w,required:!0}),(0,c.createElement)(T,{label:"Deskripsi",name:"description",value:p.description,onChange:w}),(0,c.createElement)(j,{label:"Harga (IDR)",name:"price",value:g,onChange:e=>{x(U(e.target.value))},required:!0}),(0,c.createElement)("div",{className:"grid grid-cols-2 gap-4"},(0,c.createElement)(j,{label:"Durasi (Hari)",name:"duration_days",type:"number",value:p.duration_days,onChange:w,required:!0}),(0,c.createElement)(M,{label:"Status",name:"status",value:p.status,onChange:w},(0,c.createElement)("option",{value:"available"},"Tersedia"),(0,c.createElement)("option",{value:"full"},"Penuh"),(0,c.createElement)("option",{value:"completed"},"Selesai"),(0,c.createElement)("option",{value:"draft"},"Draft"))),(0,c.createElement)("div",{className:"grid grid-cols-2 gap-4"},(0,c.createElement)(j,{label:"Tanggal Mulai",name:"start_date",type:"date",value:p.start_date,onChange:w,required:!0}),(0,c.createElement)(j,{label:"Tanggal Selesai",name:"end_date",type:"date",value:p.end_date,onChange:w,required:!0})),(0,c.createElement)("div",{className:"grid grid-cols-2 gap-4"},(0,c.createElement)(j,{label:"Kota Keberangkatan",name:"departure_city",value:p.departure_city,onChange:w,required:!0}),(0,c.createElement)(j,{label:"Total Kursi",name:"total_seats",type:"number",value:p.total_seats,onChange:w,required:!0})),(0,c.createElement)(j,{label:"Kursi Tersedia",name:"available_seats",type:"number",value:p.available_seats,onChange:w,required:!0}),(0,c.createElement)("fieldset",{className:"space-y-2"},(0,c.createElement)("legend",{className:"text-sm font-medium text-gray-700"},"Fasilitas Termasuk"),(0,c.createElement)(D,{label:"Termasuk Penerbangan",name:"includes_flights",checked:p.includes_flights,onChange:w}),(0,c.createElement)(D,{label:"Termasuk Hotel",name:"includes_hotels",checked:p.includes_hotels,onChange:w}),(0,c.createElement)(D,{label:"Termasuk Visa",name:"includes_visa",checked:p.includes_visa,onChange:w})),(0,c.createElement)(T,{label:"Daftar Fasilitas (satu per baris)",name:"includes",value:f,onChange:e=>{b(e.target.value)},rows:5,placeholder:"Hotel Bintang 5\nMakan 3x Sehari\nBus AC"}),(0,c.createElement)("div",null,(0,c.createElement)("h4",{className:"text-lg font-medium text-gray-800 mb-2"},"Itinerary"),y.map((e,t)=>(0,c.createElement)("div",{key:t,className:"space-y-2 border p-4 rounded-lg mb-4 bg-gray-50 relative"},(0,c.createElement)(j,{label:`Hari ke-${e.day}`,name:`itinerary-title-${t}`,value:e.title,onChange:e=>v(t,"title",e.target.value),placeholder:"Judul/Lokasi (cth: Madinah)"}),(0,c.createElement)(T,{label:"Detail",name:`itinerary-details-${t}`,value:e.details,onChange:e=>v(t,"details",e.target.value),rows:3,placeholder:"Detail kegiatan..."}),y.length>1&&(0,c.createElement)(S,{type:"button",variant:"danger",size:"sm",onClick:()=>(e=>{const t=y.filter((t,a)=>a!==e);h(t)})(t),className:"absolute top-2 right-2"},(0,c.createElement)(se,{className:"w-4 h-4"})))),(0,c.createElement)(S,{type:"button",variant:"secondary",onClick:()=>{h([...y,{day:`${y.length+1}`,title:"",details:""}])}},(0,c.createElement)(ce,{className:"w-4 h-4 mr-2"}),"Tambah Hari")),(0,c.createElement)("div",{className:"flex justify-end space-x-3 pt-4 border-t"},(0,c.createElement)(S,{type:"button",variant:"secondary",onClick:t,disabled:m||l},"Batal"),(0,c.createElement)(S,{type:"submit",disabled:m||l},m||l?(0,c.createElement)(k,null):e?"Update Paket":"Simpan Paket")))},me=()=>{const e=E(),{data:t,loading:a,error:s}=e,[i,m]=(0,c.useState)(""),[o,d]=(0,c.useState)({isOpen:!1,data:null}),[p,u]=(0,c.useState)({isOpen:!1,title:"",message:"",onConfirm:()=>{}});if(a)return(0,c.createElement)(l.default,null);if(s)return(0,c.createElement)(n.default,{message:s});const g=(0,c.useMemo)(()=>(t.packages||[]).filter(e=>e.name.toLowerCase().includes(i.toLowerCase())||e.description&&e.description.toLowerCase().includes(i.toLowerCase())),[t.packages,i]);return(0,c.createElement)("div",{className:"container mx-auto p-6"},(0,c.createElement)("h1",{className:"text-3xl font-bold mb-6"},"Manajemen Paket Umroh"),(0,c.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,c.createElement)("input",{type:"text",placeholder:"Cari paket (nama, deskripsi)...",className:"px-4 py-2 border rounded-lg w-1/3",value:i,onChange:e=>m(e.target.value)}),(0,c.createElement)("button",{onClick:()=>d({isOpen:!0,data:null}),className:"px-4 py-2 bg-blue-600 text-white rounded-lg shadow-sm hover:bg-blue-700"},"+ Tambah Paket Baru")),(0,c.createElement)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden"},(0,c.createElement)("table",{className:"min-w-full divide-y divide-gray-200"},(0,c.createElement)("thead",{className:"bg-gray-50"},(0,c.createElement)("tr",null,(0,c.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Nama Paket"),(0,c.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Durasi"),(0,c.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Harga Mulai"),(0,c.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tanggal"),(0,c.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),(0,c.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Aksi"))),(0,c.createElement)("tbody",{className:"bg-white divide-y divide-gray-200"},g.map(t=>(0,c.createElement)("tr",{key:t.id,className:"border-b hover:bg-gray-50"},(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900"},t.name),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700"},t.duration),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-700 font-semibold"},U((e=>{if(!e)return 0;try{let t;t="string"==typeof e?JSON.parse(e):e;const a=Array.isArray(t)?t.map(e=>parseFloat(e.price)):Object.values(t).map(e=>parseFloat(e));return 0===a.length?0:Math.min(...a.filter(e=>e>0))}catch(t){return console.error("Gagal parse harga:",e,t),0}})(t.price_details))),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700"},t.start_date?`${q(t.start_date)} - ${q(t.end_date)}`:"Fleksibel"),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap"},(0,c.createElement)("span",{className:"px-2 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full "+("published"===t.status?"bg-green-100 text-green-800":"draft"===t.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800")},t.status)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},(0,c.createElement)("div",{className:"flex items-center space-x-2"},(0,c.createElement)("button",{onClick:()=>(e=>{d({isOpen:!0,data:e})})(t),className:"text-blue-600 hover:text-blue-900"},"Edit"),(0,c.createElement)("button",{onClick:()=>{return a=t.id,void u({isOpen:!0,title:"Konfirmasi Hapus",message:"Apakah Anda yakin ingin menghapus paket ini?",onConfirm:async()=>{try{await e.deleteItem("package",a),e.refreshData("packages"),u({...p,isOpen:!1})}catch(e){console.error("Gagal menghapus paket:",e),u({...p,isOpen:!1})}}});var a},className:"text-red-600 hover:text-red-900"},"Hapus"))))),0===g.length&&(0,c.createElement)("tr",null,(0,c.createElement)("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500"},"Tidak ada data paket yang ditemukan."))))),p.isOpen&&(0,c.createElement)(r.default,{title:p.title,onClose:()=>u({...p,isOpen:!1})},(0,c.createElement)("p",{className:"mb-6"},p.message),(0,c.createElement)("div",{className:"flex justify-end space-x-4"},(0,c.createElement)("button",{onClick:()=>u({...p,isOpen:!1}),className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400"},"Batal"),(0,c.createElement)("button",{onClick:p.onConfirm,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"},"Konfirmasi"))),o.isOpen&&(0,c.createElement)(r.default,{title:o.data?"Edit Paket":"Tambah Paket Baru",onClose:()=>d({isOpen:!1,data:null})},(0,c.createElement)(ie,{data:o.data,onSuccess:()=>{d({isOpen:!1,data:null}),e.refreshData("packages")}})))},oe=({initialData:e,onSubmit:t,onCancel:a,packages:l})=>{const[n,r]=(0,c.useState)({package_id:"",full_name:"",id_number:"",phone:"",email:"",address:"",gender:"male",birth_date:"",passport_number:"",status:"pending",total_price:"",equipment_status:"belum_di_kirim",is_passport_verified:!1,is_ktp_verified:!1,is_kk_verified:!1,is_meningitis_verified:!1});(0,c.useEffect)(()=>{r(e?t=>({...t,...e,is_passport_verified:!!e.is_passport_verified,is_ktp_verified:!!e.is_ktp_verified,is_kk_verified:!!e.is_kk_verified,is_meningitis_verified:!!e.is_meningitis_verified,birth_date:z(e.birth_date)}):{package_id:"",full_name:"",id_number:"",phone:"",email:"",address:"",gender:"male",birth_date:"",passport_number:"",status:"pending",total_price:"",equipment_status:"belum_di_kirim",is_passport_verified:!1,is_ktp_verified:!1,is_kk_verified:!1,is_meningitis_verified:!1})},[e]);const s=e=>{const{name:t,value:a,type:l,checked:n}=e.target;r(e=>({...e,[t]:"checkbox"===l?n:a}))};return(0,c.createElement)("form",{onSubmit:e=>{e.preventDefault(),t(n)}},(0,c.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},(0,c.createElement)(P,{className:"md:col-span-2"},(0,c.createElement)(L,{htmlFor:"package_id"},"Paket yang Diambil"),(0,c.createElement)(M,{name:"package_id",id:"package_id",value:n.package_id,onChange:s,required:!0},(0,c.createElement)("option",{value:""},"Pilih Paket"),l.map(e=>(0,c.createElement)("option",{key:e.id,value:e.id},e.title," (",e.departure_date?z(e.departure_date):"N/A",")")))),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"full_name"},"Nama Lengkap"),(0,c.createElement)(j,{type:"text",name:"full_name",id:"full_name",value:n.full_name,onChange:s,required:!0})),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"id_number"},"No. KTP (NIK)"),(0,c.createElement)(j,{type:"text",name:"id_number",id:"id_number",value:n.id_number,onChange:s,required:!0})),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"phone"},"No. Telepon (WA)"),(0,c.createElement)(j,{type:"tel",name:"phone",id:"phone",value:n.phone,onChange:s})),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"email"},"Email"),(0,c.createElement)(j,{type:"email",name:"email",id:"email",value:n.email,onChange:s})),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"birth_date"},"Tanggal Lahir"),(0,c.createElement)(j,{type:"date",name:"birth_date",id:"birth_date",value:n.birth_date,onChange:s})),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"gender"},"Jenis Kelamin"),(0,c.createElement)(M,{name:"gender",id:"gender",value:n.gender,onChange:s},(0,c.createElement)("option",{value:"male"},"Laki-laki"),(0,c.createElement)("option",{value:"female"},"Perempuan"))),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"passport_number"},"No. Paspor"),(0,c.createElement)(j,{type:"text",name:"passport_number",id:"passport_number",value:n.passport_number,onChange:s})),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"address"},"Alamat"),(0,c.createElement)(j,{type:"text",name:"address",id:"address",value:n.address,onChange:s})),(0,c.createElement)("hr",{className:"md:col-span-2"}),(0,c.createElement)("h4",{className:"md:col-span-2 text-lg font-semibold text-gray-800 -mb-2"},"Administrasi & Keuangan"),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"status"},"Status Jemaah"),(0,c.createElement)(M,{name:"status",id:"status",value:n.status,onChange:s},(0,c.createElement)("option",{value:"pending"},"Pending"),(0,c.createElement)("option",{value:"approved"},"Approved"),(0,c.createElement)("option",{value:"rejected"},"Rejected"),(0,c.createElement)("option",{value:"waitlist"},"Waitlist"))),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"total_price"},"Total Tagihan (Rp)"),(0,c.createElement)(j,{type:"number",name:"total_price",id:"total_price",value:n.total_price,onChange:s,placeholder:"Otomatis jika kosong"})),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"equipment_status"},"Status Perlengkapan"),(0,c.createElement)(M,{name:"equipment_status",id:"equipment_status",value:n.equipment_status,onChange:s},(0,c.createElement)("option",{value:"belum_di_kirim"},"Belum Dikirim"),(0,c.createElement)("option",{value:"di_kirim"},"Dikirim"),(0,c.createElement)("option",{value:"diterima"},"Diterima"))),(0,c.createElement)("hr",{className:"md:col-span-2"}),(0,c.createElement)("h4",{className:"md:col-span-2 text-lg font-semibold text-gray-800 -mb-2"},"Checklist Verifikasi Dokumen (Admin)"),(0,c.createElement)(P,null,(0,c.createElement)(D,{name:"is_passport_verified",id:"is_passport_verified",checked:!!n.is_passport_verified,onChange:s,label:"Paspor Verified"})),(0,c.createElement)(P,null,(0,c.createElement)(D,{name:"is_ktp_verified",id:"is_ktp_verified",checked:!!n.is_ktp_verified,onChange:s,label:"KTP Verified"})),(0,c.createElement)(P,null,(0,c.createElement)(D,{name:"is_kk_verified",id:"is_kk_verified",checked:!!n.is_kk_verified,onChange:s,label:"KK Verified"})),(0,c.createElement)(P,null,(0,c.createElement)(D,{name:"is_meningitis_verified",id:"is_meningitis_verified",checked:!!n.is_meningitis_verified,onChange:s,label:"Meningitis Verified"}))),(0,c.createElement)(O,{onCancel:a}))},de=w("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),pe=w("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),ue=w("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]),ge=({openModal:e})=>{const{data:t,loading:a,error:l,createOrUpdate:n,deleteItem:r}=E(),{printUrl:s}=y(),[i,m]=(0,c.useState)(!1),[o,d]=(0,c.useState)(null),[p,u]=(0,c.useState)(""),g=(e=null)=>{d(e),m(!0)},x=()=>{d(null),m(!1)},h=(0,c.useMemo)(()=>t.jamaah.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())||e.email.toLowerCase().includes(p.toLowerCase())||e.phone.toLowerCase().includes(p.toLowerCase())||e.package_name&&e.package_name.toLowerCase().includes(p.toLowerCase())),[t.jamaah,p]);return a&&!t.jamaah.length?(0,c.createElement)(N,{message:"Memuat data jamaah..."}):l?(0,c.createElement)(_,{title:"Gagal Memuat",message:l}):(0,c.createElement)("div",{className:"space-y-6"},(0,c.createElement)("div",{className:"flex flex-col md:flex-row justify-between items-center"},(0,c.createElement)("h1",{className:"text-3xl font-bold text-gray-800"},"Manajemen Jamaah"),(0,c.createElement)(S,{onClick:()=>g(),className:"mt-4 md:mt-0"},(0,c.createElement)(ce,{className:"w-4 h-4 mr-2"}),"Tambah Jamaah")),(0,c.createElement)("div",{className:"bg-white p-6 rounded-lg shadow"},(0,c.createElement)("div",{className:"flex items-center mb-4"},(0,c.createElement)(de,{className:"w-5 h-5 text-gray-500 mr-2"}),(0,c.createElement)(j,{type:"text",placeholder:"Cari berdasarkan nama, email, telepon, atau paket...",value:p,onChange:e=>u(e.target.value),className:"max-w-sm"})),(0,c.createElement)("div",{className:"overflow-x-auto"},(0,c.createElement)("table",{className:"min-w-full divide-y divide-gray-200"},(0,c.createElement)("thead",{className:"bg-gray-50"},(0,c.createElement)("tr",null,(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Nama"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Kontak"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Paket"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status Bayar"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Dokumen"),(0,c.createElement)("th",{scope:"col",className:"relative px-6 py-3"},(0,c.createElement)("span",{className:"sr-only"},"Aksi")))),(0,c.createElement)("tbody",{className:"bg-white divide-y divide-gray-200"},a&&(0,c.createElement)("tr",null,(0,c.createElement)("td",{colSpan:"6",className:"text-center p-4"},(0,c.createElement)(k,null))),!a&&0===h.length&&(0,c.createElement)("tr",null,(0,c.createElement)("td",{colSpan:"6",className:"text-center p-4 text-gray-500"},"Data tidak ditemukan.")),!a&&h.map(t=>{const a={paid:{text:"Lunas",color:"bg-green-100 text-green-800"},down_payment:{text:"DP",color:"bg-blue-100 text-blue-800"},unpaid:{text:"Belum Bayar",color:"bg-red-100 text-red-800"},pending:{text:"Pending",color:"bg-yellow-100 text-yellow-800"}}[t.payment_status||"unpaid"],l="complete"===t.document_status;return(0,c.createElement)("tr",{key:t.id},(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},t.name),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},(0,c.createElement)("div",null,t.email),(0,c.createElement)("div",null,t.phone)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},t.package_name||"-"),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap"},(0,c.createElement)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${a.color}`},a.text)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap"},(0,c.createElement)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(l?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800")},l?"Lengkap":"Belum")),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2"},(0,c.createElement)(S,{title:"Cetak Formulir",variant:"icon",size:"sm",onClick:()=>(e=>{const t=`${s}&jamaah_id=${e}`;window.open(t,"_blank")})(t.id)},(0,c.createElement)(pe,{className:"w-4 h-4"})),(0,c.createElement)(S,{title:"Lihat Pembayaran",variant:"icon",size:"sm",onClick:()=>e("jamaahPayments",{jamaah:t})},(0,c.createElement)(Z,{className:"w-4 h-4"})),(0,c.createElement)(S,{title:"Edit Jamaah",variant:"icon",size:"sm",onClick:()=>g(t)},(0,c.createElement)(ue,{className:"w-4 h-4"})),(0,c.createElement)(S,{title:"Hapus Jamaah",variant:"icon",size:"sm",color:"danger",onClick:()=>(async e=>{if(window.confirm("Apakah Anda yakin ingin menghapus data jamaah ini?"))try{await r("jamaah",e)}catch(e){alert("Gagal menghapus: "+e.message)}})(t.id)},(0,c.createElement)(se,{className:"w-4 h-4"}))))}))))),i&&(0,c.createElement)(F,{title:o?"Edit Jamaah":"Tambah Jamaah",onClose:x},(0,c.createElement)("div",{className:"p-6"},(0,c.createElement)(oe,{data:o,onClose:x}))))},xe=({initialData:e,onSubmit:t,onCancel:a,accounts:l})=>{const[n,r]=(0,c.useState)({transaction_date:z(new Date),description:"",transaction_type:"expense",amount:"",account_id:""});(0,c.useEffect)(()=>{r(e?t=>({...t,...e,transaction_date:z(e.transaction_date)}):{transaction_date:z(new Date),description:"",transaction_type:"expense",amount:"",account_id:""})},[e]);const s=e=>{const{name:t,value:a}=e.target;r(e=>({...e,[t]:a}))};return(0,c.createElement)("form",{onSubmit:e=>{e.preventDefault(),t(n)}},(0,c.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"transaction_date"},"Tanggal"),(0,c.createElement)(j,{type:"date",name:"transaction_date",id:"transaction_date",value:n.transaction_date,onChange:s,required:!0})),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"account_id"},"Akun"),(0,c.createElement)(M,{name:"account_id",id:"account_id",value:n.account_id,onChange:s,required:!0},(0,c.createElement)("option",{value:""},"Pilih Akun Kas"),l.map(e=>(0,c.createElement)("option",{key:e.id,value:e.id},e.name)))),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"transaction_type"},"Jenis Transaksi"),(0,c.createElement)(M,{name:"transaction_type",id:"transaction_type",value:n.transaction_type,onChange:s,required:!0},(0,c.createElement)("option",{value:"expense"},"Debit (Pengeluaran)"),(0,c.createElement)("option",{value:"income"},"Kredit (Pemasukan)"))),(0,c.createElement)(P,null,(0,c.createElement)(L,{htmlFor:"amount"},"Jumlah (Rp)"),(0,c.createElement)(j,{type:"number",name:"amount",id:"amount",value:n.amount,onChange:s,required:!0})),(0,c.createElement)(P,{className:"md:col-span-2"},(0,c.createElement)(L,{htmlFor:"description"},"Deskripsi"),(0,c.createElement)(j,{type:"text",name:"description",id:"description",value:n.description,onChange:s}))),(0,c.createElement)(O,{onCancel:a}))},ye=w("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),he=w("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Ee=({label:e,value:t,color:a,icon:l})=>(0,c.createElement)("div",{className:"bg-white p-4 rounded-lg shadow flex items-center"},(0,c.createElement)("div",{className:`p-3 rounded-full ${a.replace("text-","bg-")} bg-opacity-10 mr-4`},i().cloneElement(l,{className:`w-6 h-6 ${a}`})),(0,c.createElement)("div",null,(0,c.createElement)("span",{className:"text-sm font-medium text-gray-500"},e),(0,c.createElement)("p",{className:`text-2xl font-bold ${a}`},t))),fe=()=>{const{data:e,loading:t,error:a,createOrUpdate:l,deleteItem:n}=E(),[r,s]=(0,c.useState)(!1),[i,m]=(0,c.useState)(null),[o,d]=(0,c.useState)(""),p=(e=null)=>{m(e),s(!0)},u=()=>{m(null),s(!1)},g=(0,c.useMemo)(()=>e.finance.filter(e=>e.description.toLowerCase().includes(o.toLowerCase())||e.category.toLowerCase().includes(o.toLowerCase())),[e.finance,o]),x=(0,c.useMemo)(()=>e.finance.filter(e=>"income"===e.type).reduce((e,t)=>e+parseFloat(t.amount),0),[e.finance]),y=(0,c.useMemo)(()=>e.finance.filter(e=>"expense"===e.type).reduce((e,t)=>e+parseFloat(t.amount),0),[e.finance]),h=x-y;return t&&!e.finance.length?(0,c.createElement)(N,{message:"Memuat data keuangan..."}):a?(0,c.createElement)(_,{title:"Gagal Memuat",message:a}):(0,c.createElement)("div",{className:"space-y-6"},(0,c.createElement)("div",{className:"flex flex-col md:flex-row justify-between items-center"},(0,c.createElement)("h1",{className:"text-3xl font-bold text-gray-800"},"Manajemen Keuangan"),(0,c.createElement)(S,{onClick:()=>p(),className:"mt-4 md:mt-0"},(0,c.createElement)(ce,{className:"w-4 h-4 mr-2"}),"Tambah Transaksi")),(0,c.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},(0,c.createElement)(Ee,{label:"Total Pemasukan",value:U(x),color:"text-green-600",icon:(0,c.createElement)(ye,null)}),(0,c.createElement)(Ee,{label:"Total Pengeluaran",value:U(y),color:"text-red-600",icon:(0,c.createElement)(he,null)}),(0,c.createElement)(Ee,{label:"Profit Bersih",value:U(h),color:h>=0?"text-blue-600":"text-red-600"})),(0,c.createElement)("div",{className:"bg-white p-6 rounded-lg shadow"},(0,c.createElement)("div",{className:"flex items-center mb-4"},(0,c.createElement)(de,{className:"w-5 h-5 text-gray-500 mr-2"}),(0,c.createElement)(j,{type:"text",placeholder:"Cari berdasarkan deskripsi atau kategori...",value:o,onChange:e=>d(e.target.value),className:"max-w-sm"})),(0,c.createElement)("div",{className:"overflow-x-auto"},(0,c.createElement)("table",{className:"min-w-full divide-y divide-gray-200"},(0,c.createElement)("thead",{className:"bg-gray-50"},(0,c.createElement)("tr",null,(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tanggal"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Deskripsi"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Kategori"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Jumlah"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tipe"),(0,c.createElement)("th",{scope:"col",className:"relative px-6 py-3"},(0,c.createElement)("span",{className:"sr-only"},"Aksi")))),(0,c.createElement)("tbody",{className:"bg-white divide-y divide-gray-200"},t&&(0,c.createElement)("tr",null,(0,c.createElement)("td",{colSpan:"6",className:"text-center p-4"},(0,c.createElement)(k,null))),!t&&0===g.length&&(0,c.createElement)("tr",null,(0,c.createElement)("td",{colSpan:"6",className:"text-center p-4 text-gray-500"},"Data tidak ditemukan.")),!t&&g.map(e=>{const t="income"===e.type,a=t?"text-green-600":"text-red-600",l=t?"+":"-";return(0,c.createElement)("tr",{key:e.id},(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},q(e.transaction_date)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},e.description),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},e.category),(0,c.createElement)("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-semibold ${a}`},l," ",U(e.amount)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap"},(0,c.createElement)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(t?"bg-green-100 text-green-800":"bg-red-100 text-red-800")},e.type)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2"},(0,c.createElement)(S,{variant:"icon",size:"sm",onClick:()=>p(e)},(0,c.createElement)(ue,{className:"w-4 h-4"})),(0,c.createElement)(S,{variant:"icon",size:"sm",color:"danger",onClick:()=>(async e=>{if(window.confirm("Apakah Anda yakin ingin menghapus data ini?"))try{await n("finance",e)}catch(e){alert("Gagal menghapus: "+e.message)}})(e.id)},(0,c.createElement)(se,{className:"w-4 h-4"}))))}))))),r&&(0,c.createElement)(F,{title:i?"Edit Transaksi":"Tambah Transaksi",onClose:u},(0,c.createElement)("div",{className:"p-6"},(0,c.createElement)(xe,{data:i,onClose:u}))))},be=({data:e,onSuccess:t})=>{const a=E(),[l,n]=(0,c.useState)({name:"",email:"",password:"",role:"marketing_staff"}),[r,s]=(0,c.useState)(!1),[i,m]=(0,c.useState)(null),o=Boolean(e&&e.id);(0,c.useEffect)(()=>{o&&e&&n({name:e.name||"",email:e.email||"",role:e.role||"marketing_staff",password:""})},[e,o]);const d=e=>{const{name:t,value:a}=e.target;n(e=>({...e,[t]:a}))},{data:p,loading:u}=a,g=p.roles||[];return(0,c.createElement)("form",{onSubmit:async n=>{n.preventDefault(),m(null),s(!0);const r={...l};o&&(r.id=e.id,r.password||delete r.password);try{await a.createOrUpdate("user",r),t()}catch(e){m(e.message||"Gagal menyimpan data. Silakan coba lagi."),console.error(e)}finally{s(!1)}},className:"space-y-4"},i&&(0,c.createElement)(_,{message:i}),(0,c.createElement)(j,{label:"Nama",id:"name",name:"name",type:"text",value:l.name,onChange:d,required:!0}),(0,c.createElement)(j,{label:"Email",id:"email",name:"email",type:"email",value:l.email,onChange:d,required:!0,disabled:o}),(0,c.createElement)(j,{label:o?"Password (Kosongkan jika tidak diubah)":"Password",id:"password",name:"password",type:"password",value:l.password,onChange:d,required:!o}),(0,c.createElement)(M,{label:"Role",id:"role",name:"role",value:l.role,onChange:d,required:!0,disabled:u},u?(0,c.createElement)("option",null,"Loading roles..."):(0,c.createElement)(c.Fragment,null,(0,c.createElement)("option",{value:"",disabled:!0},"Pilih Role"),g.map(e=>(0,c.createElement)("option",{key:e.role_key,value:e.role_key},e.display_name)),0===g.length&&!u&&(0,c.createElement)(c.Fragment,null,(0,c.createElement)("option",{value:"marketing_staff"},"Marketing Staff"),(0,c.createElement)("option",{value:"finance_staff"},"Finance Staff"),(0,c.createElement)("option",{value:"hr_staff"},"HR Staff")))),(0,c.createElement)("div",{className:"pt-2"},(0,c.createElement)("button",{type:"submit",disabled:r||u,className:"w-full px-4 py-2 font-semibold text-white bg-blue-600 rounded-lg shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:bg-gray-400 disabled:cursor-not-allowed"},r?"Menyimpan...":o?"Update User":"Tambah User")))},we=w("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),ve=w("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),ke=()=>{const{data:e,loading:t,error:a,createOrUpdate:l,deleteItem:n}=E(),[r,s]=(0,c.useState)(!1),[i,m]=(0,c.useState)(null),[o,d]=(0,c.useState)(""),p=(e=null)=>{m(e),s(!0)},u=()=>{m(null),s(!1)},g=(0,c.useMemo)(()=>e.hr.filter(e=>e.full_name.toLowerCase().includes(o.toLowerCase())||e.user_email.toLowerCase().includes(o.toLowerCase())||e.role_name.toLowerCase().includes(o.toLowerCase())),[e.hr,o]);return t&&!e.hr.length?(0,c.createElement)(N,{message:"Memuat data HR..."}):a?(0,c.createElement)(_,{title:"Gagal Memuat",message:a}):(0,c.createElement)("div",{className:"space-y-6"},(0,c.createElement)("div",{className:"flex flex-col md:flex-row justify-between items-center"},(0,c.createElement)("h1",{className:"text-3xl font-bold text-gray-800"},"Manajemen Staff (HR)"),(0,c.createElement)(S,{onClick:()=>p(),className:"mt-4 md:mt-0"},(0,c.createElement)(ce,{className:"w-4 h-4 mr-2"}),"Tambah Staff")),(0,c.createElement)("div",{className:"bg-white p-6 rounded-lg shadow"},(0,c.createElement)("div",{className:"flex items-center mb-4"},(0,c.createElement)(de,{className:"w-5 h-5 text-gray-500 mr-2"}),(0,c.createElement)(j,{type:"text",placeholder:"Cari berdasarkan nama, email, atau role...",value:o,onChange:e=>d(e.target.value),className:"max-w-sm"})),(0,c.createElement)("div",{className:"overflow-x-auto"},(0,c.createElement)("table",{className:"min-w-full divide-y divide-gray-200"},(0,c.createElement)("thead",{className:"bg-gray-50"},(0,c.createElement)("tr",null,(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Nama Lengkap"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Email"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Role"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),(0,c.createElement)("th",{scope:"col",className:"relative px-6 py-3"},(0,c.createElement)("span",{className:"sr-only"},"Aksi")))),(0,c.createElement)("tbody",{className:"bg-white divide-y divide-gray-200"},t&&(0,c.createElement)("tr",null,(0,c.createElement)("td",{colSpan:"5",className:"text-center p-4"},(0,c.createElement)(k,null))),!t&&0===g.length&&(0,c.createElement)("tr",null,(0,c.createElement)("td",{colSpan:"5",className:"text-center p-4 text-gray-500"},"Data tidak ditemukan.")),!t&&g.map(e=>(0,c.createElement)("tr",{key:e.ID},(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},e.full_name),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},e.user_email),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},e.role_name),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap"},(0,c.createElement)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+("active"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800")},"active"===e.status?(0,c.createElement)(we,{className:"w-4 h-4 mr-1"}):(0,c.createElement)(ve,{className:"w-4 h-4 mr-1"}),e.status)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2"},(0,c.createElement)(S,{variant:"icon",size:"sm",onClick:()=>p(e)},(0,c.createElement)(ue,{className:"w-4 h-4"})),(0,c.createElement)(S,{variant:"icon",size:"sm",color:"danger",onClick:()=>(async e=>{if(window.confirm("Apakah Anda yakin ingin menghapus data staff ini?"))try{await n("hr",e)}catch(e){alert("Gagal menghapus: "+e.message)}})(e.ID)},(0,c.createElement)(se,{className:"w-4 h-4"}))))))))),r&&(0,c.createElement)(F,{title:i?"Edit Staff":"Tambah Staff",onClose:u},(0,c.createElement)("div",{className:"p-6"},(0,c.createElement)(be,{data:i,onClose:u}))))},Ne=({data:e,onClose:t})=>{const{createOrUpdate:a,loading:l,error:n}=E(),[r,s]=(0,c.useState)(e||{name:"",email:"",phone:"",source:"Website",status:"new",notes:""}),[i,m]=(0,c.useState)(null);(0,c.useEffect)(()=>{n&&m(n)},[n]);const o=e=>{const{name:t,value:a}=e.target;s(e=>({...e,[t]:a}))};return(0,c.createElement)("form",{onSubmit:async l=>{l.preventDefault(),m(null);const n={...r};e&&e.id&&(n.id=e.id);try{await a("marketing",n),t()}catch(e){m(e.message||"Gagal menyimpan lead.")}},className:"space-y-4"},i&&(0,c.createElement)(_,{message:i}),(0,c.createElement)(j,{label:"Nama",name:"name",value:r.name,onChange:o,required:!0}),(0,c.createElement)(j,{label:"Email",name:"email",type:"email",value:r.email,onChange:o}),(0,c.createElement)(j,{label:"Telepon",name:"phone",value:r.phone,onChange:o,required:!0}),(0,c.createElement)(M,{label:"Sumber Lead",name:"source",value:r.source,onChange:o},(0,c.createElement)("option",{value:"Website"},"Website"),(0,c.createElement)("option",{value:"Walk-in"},"Walk-in"),(0,c.createElement)("option",{value:"Referral"},"Referral"),(0,c.createElement)("option",{value:"Social Media"},"Social Media"),(0,c.createElement)("option",{value:"Other"},"Lainnya")),(0,c.createElement)(M,{label:"Status",name:"status",value:r.status,onChange:o},(0,c.createElement)("option",{value:"new"},"Baru"),(0,c.createElement)("option",{value:"contacted"},"Dihubungi"),(0,c.createElement)("option",{value:"qualified"},"Kualifikasi"),(0,c.createElement)("option",{value:"lost"},"Gagal"),(0,c.createElement)("option",{value:"converted"},"Konversi")),(0,c.createElement)(T,{label:"Catatan",name:"notes",value:r.notes,onChange:o,rows:4}),(0,c.createElement)("div",{className:"flex justify-end space-x-2 pt-4 border-t"},(0,c.createElement)(S,{type:"button",variant:"secondary",onClick:t,disabled:l},"Batal"),(0,c.createElement)(S,{type:"submit",disabled:l},l?(0,c.createElement)(k,null):e?"Update":"Simpan")))},_e=w("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Ce=w("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Se=()=>{const{data:e,loading:t,error:a,createOrUpdate:l,deleteItem:n}=E(),[r,s]=(0,c.useState)(!1),[i,m]=(0,c.useState)(null),[o,d]=(0,c.useState)(""),p=(e=null)=>{m(e),s(!0)},u=()=>{m(null),s(!1)},g=(0,c.useMemo)(()=>e.marketing.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.email.toLowerCase().includes(o.toLowerCase())||e.phone.toLowerCase().includes(o.toLowerCase())||e.status.toLowerCase().includes(o.toLowerCase())),[e.marketing,o]);return t&&!e.marketing.length?(0,c.createElement)(N,{message:"Memuat data marketing..."}):a?(0,c.createElement)(_,{title:"Gagal Memuat",message:a}):(0,c.createElement)("div",{className:"space-y-6"},(0,c.createElement)("div",{className:"flex flex-col md:flex-row justify-between items-center"},(0,c.createElement)("h1",{className:"text-3xl font-bold text-gray-800"},"Manajemen Leads"),(0,c.createElement)(S,{onClick:()=>p(),className:"mt-4 md:mt-0"},(0,c.createElement)(ce,{className:"w-4 h-4 mr-2"}),"Tambah Lead")),(0,c.createElement)("div",{className:"bg-white p-6 rounded-lg shadow"},(0,c.createElement)("div",{className:"flex items-center mb-4"},(0,c.createElement)(de,{className:"w-5 h-5 text-gray-500 mr-2"}),(0,c.createElement)(j,{type:"text",placeholder:"Cari berdasarkan nama, email, telepon, atau status...",value:o,onChange:e=>d(e.target.value),className:"max-w-sm"})),(0,c.createElement)("div",{className:"overflow-x-auto"},(0,c.createElement)("table",{className:"min-w-full divide-y divide-gray-200"},(0,c.createElement)("thead",{className:"bg-gray-50"},(0,c.createElement)("tr",null,(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Nama"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Kontak"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Sumber"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),(0,c.createElement)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tanggal"),(0,c.createElement)("th",{scope:"col",className:"relative px-6 py-3"},(0,c.createElement)("span",{className:"sr-only"},"Aksi")))),(0,c.createElement)("tbody",{className:"bg-white divide-y divide-gray-200"},t&&(0,c.createElement)("tr",null,(0,c.createElement)("td",{colSpan:"6",className:"text-center p-4"},(0,c.createElement)(k,null))),!t&&0===g.length&&(0,c.createElement)("tr",null,(0,c.createElement)("td",{colSpan:"6",className:"text-center p-4 text-gray-500"},"Data tidak ditemukan.")),!t&&g.map(e=>{const t=(e=>{switch(e){case"new":return{text:"Baru",color:"bg-blue-100 text-blue-800"};case"contacted":return{text:"Dihubungi",color:"bg-yellow-100 text-yellow-800"};case"qualified":return{text:"Kualifikasi",color:"bg-indigo-100 text-indigo-800"};case"lost":return{text:"Gagal",color:"bg-red-100 text-red-800"};case"converted":return{text:"Konversi",color:"bg-green-100 text-green-800"};default:return{text:e,color:"bg-gray-100 text-gray-800"}}})(e.status);return(0,c.createElement)("tr",{key:e.id},(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},e.name),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},e.email&&(0,c.createElement)("div",null,(0,c.createElement)(_e,{className:"w-4 h-4 inline mr-1"})," ",e.email),e.phone&&(0,c.createElement)("div",null,(0,c.createElement)(Ce,{className:"w-4 h-4 inline mr-1"})," ",e.phone)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},e.source),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap"},(0,c.createElement)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.color}`},t.text)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},q(e.created_at)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2"},(0,c.createElement)(S,{variant:"icon",size:"sm",onClick:()=>p(e)},(0,c.createElement)(ue,{className:"w-4 h-4"})),(0,c.createElement)(S,{variant:"icon",size:"sm",color:"danger",onClick:()=>(async e=>{if(window.confirm("Apakah Anda yakin ingin menghapus data lead ini?"))try{await n("marketing",e)}catch(e){alert("Gagal menghapus: "+e.message)}})(e.id)},(0,c.createElement)(se,{className:"w-4 h-4"}))))}))))),r&&(0,c.createElement)(F,{title:i?"Edit Lead":"Tambah Lead",onClose:u},(0,c.createElement)("div",{className:"p-6"},(0,c.createElement)(Ne,{data:i,onClose:u}))))},je=()=>{const{logs:e,users:t,loadingLogs:a,error:l,fetchLogs:n}=E();return(0,c.useEffect)(()=>{n()},[n]),(0,c.createElement)("div",{className:"bg-white shadow-lg rounded-lg p-6 relative min-h-[300px]"},(0,c.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,c.createElement)("h2",{className:"text-2xl font-semibold text-gray-800"},"Log Aktivitas")),l&&(0,c.createElement)(_,{message:l}),a&&(0,c.createElement)(k,null),!a&&!l&&(0,c.createElement)("div",{className:"overflow-x-auto"},(0,c.createElement)("table",{className:"min-w-full divide-y divide-gray-200"},(0,c.createElement)("thead",{className:"bg-gray-50"},(0,c.createElement)("tr",null,(0,c.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Waktu"),(0,c.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Pengguna"),(0,c.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Aksi"),(0,c.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Objek"),(0,c.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"ID Objek"),(0,c.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Detail"))),(0,c.createElement)("tbody",{className:"bg-white divide-y divide-gray-200"},0===e.length&&(0,c.createElement)("tr",null,(0,c.createElement)("td",{colSpan:"6",className:"px-6 py-4 text-center text-gray-500"},"Tidak ada log.")),e.map(e=>(0,c.createElement)("tr",{key:e.id,className:"hover:bg-gray-50"},(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},q(e.created_at)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},(e=>{const a=t.find(t=>t.id==e);return a?a.full_name:"Sistem"})(e.user_id)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap"},B(e.action)),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},e.object_type),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},e.object_id),(0,c.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 truncate max-w-xs"},e.details)))))))},Me=(...e)=>e.filter(Boolean).join(" "),Te=()=>{const[e,t]=(0,c.useState)("dashboard"),[a,l]=(0,c.useState)(!1),[n,r]=(0,c.useState)({type:null,props:{}}),{currentUser:s,adminUrl:i}=y(),{loading:m,error:o,refreshData:d}=E(),p=(e=>{const t={dashboard:{name:"Dashboard",icon:G,page:"dashboard"},packages:{name:"Paket",icon:W,page:"packages"},jamaah:{name:"Jamaah",icon:V,page:"jamaah"},finance:{name:"Keuangan",icon:Z,page:"finance"},hr:{name:"HR",icon:X,page:"hr"},marketing:{name:"Marketing",icon:Y,page:"marketing"},logs:{name:"Logs",icon:Q,page:"logs"}},a={administrator:["dashboard","packages","jamaah","finance","hr","marketing","logs"],owner:["dashboard","packages","jamaah","finance","hr","marketing","logs"],admin_staff:["dashboard","packages","jamaah","marketing"],finance_staff:["dashboard","finance","jamaah"],marketing_staff:["dashboard","marketing","jamaah"],hr_staff:["dashboard","hr","jamaah"],subscriber:["dashboard"]};return(a[e]||a.subscriber).map(e=>t[e])})(s?.role||"subscriber"),u=i?`${i.replace(/admin\.php\?page=.*$/,"")}wp-login.php?action=logout`:"#";return m&&!o?(0,c.createElement)(N,{message:"Memuat data aplikasi..."}):o?(0,c.createElement)(_,{title:"Error Aplikasi",message:o},(0,c.createElement)(S,{onClick:d,disabled:m},m?(0,c.createElement)(k,null):"Coba Lagi")):s?(0,c.createElement)("div",{className:"flex h-screen bg-gray-100 font-sans"},(()=>{if(!n.type)return null;return"jamaahPayments"===n.type?(0,c.createElement)(J,{jamaah:n.props.jamaah,onClose:()=>r({type:null,props:{}})}):(console.warn("Modal type not recognized:",n.type),null)})(),(0,c.createElement)("aside",{className:"hidden w-64 flex-shrink-0 flex-col bg-white shadow-lg md:flex"},(0,c.createElement)("div",{className:"flex h-16 flex-shrink-0 items-center justify-center bg-gray-900 text-white"},(0,c.createElement)(X,{className:"h-8 w-8 text-blue-400"}),(0,c.createElement)("span",{className:"ml-2 text-xl font-semibold"},"Umroh Manager")),(0,c.createElement)("nav",{className:"flex-1 overflow-y-auto"},p.map(a=>(0,c.createElement)("a",{key:a.page,href:"#",onClick:e=>{e.preventDefault(),t(a.page)},className:Me("flex items-center px-6 py-3 text-gray-600 hover:bg-blue-50 hover:text-blue-600",e===a.page&&"border-r-4 border-blue-500 bg-blue-50 text-blue-600")},(0,c.createElement)(a.icon,{className:"h-5 w-5"}),(0,c.createElement)("span",{className:"ml-3"},a.name)))),(0,c.createElement)("div",{className:"border-t p-4"},(0,c.createElement)("a",{href:u,className:"flex w-full items-center rounded-lg px-4 py-2 text-gray-500 hover:bg-red-100 hover:text-red-700"},(0,c.createElement)(ee,{className:"h-5 w-5"}),(0,c.createElement)("span",{className:"ml-3"},"Logout")))),(0,c.createElement)("div",{className:Me("fixed inset-0 z-30 bg-black bg-opacity-50 transition-opacity md:hidden",a?"pointer-events-auto opacity-100":"pointer-events-none opacity-0"),onClick:()=>l(!1)}),(0,c.createElement)("aside",{className:Me("fixed inset-y-0 left-0 z-40 w-64 transform bg-white shadow-lg transition-transform duration-300 ease-in-out md:hidden",a?"translate-x-0":"-translate-x-full")},(0,c.createElement)("div",{className:"flex h-16 items-center justify-between bg-gray-900 px-4 text-white"},(0,c.createElement)("div",{className:"flex items-center"},(0,c.createElement)(X,{className:"h-8 w-8 text-blue-400"}),(0,c.createElement)("span",{className:"ml-2 text-xl font-semibold"},"UMH")),(0,c.createElement)("button",{onClick:()=>l(!1),className:"text-gray-300 hover:text-white"},(0,c.createElement)(A,{className:"h-6 w-6"}))),(0,c.createElement)("nav",{className:"flex-1 overflow-y-auto pt-4"},p.map(a=>(0,c.createElement)("a",{key:a.page,href:"#",onClick:e=>{e.preventDefault(),t(a.page),l(!1)},className:Me("flex items-center px-6 py-3 text-gray-600 hover:bg-blue-50 hover:text-blue-600",e===a.page&&"border-r-4 border-blue-500 bg-blue-50 text-blue-600")},(0,c.createElement)(a.icon,{className:"h-5 w-5"}),(0,c.createElement)("span",{className:"ml-3"},a.name)))),(0,c.createElement)("div",{className:"border-t p-4"},(0,c.createElement)("a",{href:u,className:"flex w-full items-center rounded-lg px-4 py-2 text-gray-500 hover:bg-red-100 hover:text-red-700"},(0,c.createElement)(ee,{className:"h-5 w-5"}),(0,c.createElement)("span",{className:"ml-3"},"Logout")))),(0,c.createElement)("div",{className:"flex flex-1 flex-col"},(0,c.createElement)("header",{className:"flex h-16 flex-shrink-0 items-center justify-between bg-white shadow-md md:justify-end"},(0,c.createElement)("button",{onClick:()=>l(!0),className:"px-4 text-gray-500 md:hidden"},(0,c.createElement)(te,{className:"h-6 w-6"})),(0,c.createElement)("div",{className:"flex items-center pr-4"},(0,c.createElement)("span",{className:"text-sm text-gray-600"},"Selamat datang, ",(0,c.createElement)("span",{className:"font-medium"},s.full_name)),(0,c.createElement)("span",{className:"ml-2 rounded-full bg-gray-200 px-2 py-0.5 text-xs font-semibold text-gray-700"},s.role))),(0,c.createElement)("main",{className:"flex-1 overflow-y-auto p-4 md:p-8"},(()=>{const t=(e,t={})=>r({type:e,props:t});switch(e){case"dashboard":default:return(0,c.createElement)(re,{openModal:t});case"packages":return(0,c.createElement)(me,{openModal:t});case"jamaah":return(0,c.createElement)(ge,{openModal:t});case"finance":return(0,c.createElement)(fe,{openModal:t});case"hr":return(0,c.createElement)(ke,{openModal:t});case"marketing":return(0,c.createElement)(Se,{openModal:t});case"logs":return(0,c.createElement)(je,{openModal:t})}})()))):(0,c.createElement)(N,{message:"Memuat data pengguna..."})},Pe=document.getElementById("umh-admin-app");Pe?(0,m.H)(Pe).render((0,c.createElement)(i().StrictMode,null,(0,c.createElement)(x,null,(0,c.createElement)(f,null,(0,c.createElement)(Te,null))))):console.error("Target element #umh-admin-app not found.")})();
(()=>{"use strict";var e={338:(e,t,a)=>{var l=a(795);t.H=l.createRoot,l.hydrateRoot},795:e=>{e.exports=window.ReactDOM}},t={};function a(l){var r=t[l];if(void 0!==r)return r.exports;var n=t[l]={exports:{}};return e[l](n,n.exports,a),n.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const l=window.React;var r=a.n(l),n=a(338);const s=window.umh_wp_data||{},c=s.user||null,m=s.nonce||null,i=s.api_url||"/wp-json/umh/v1",o=(0,l.createContext)(),d=({children:e})=>{const[t,a]=(0,l.useState)(c),r={currentUser:t,setCurrentUser:a,nonce:m,apiUrl:i,adminUrl:s.adminUrl,printUrl:s.printUrl,isWpAdmin:s.is_wp_admin||!1};return(0,l.createElement)(o.Provider,{value:r},e)},u=()=>(0,l.useContext)(o),p=(0,l.createContext)(),g=()=>(0,l.useContext)(p),b=({children:e})=>{const[t,a]=(0,l.useState)(!1),{apiUrl:r,nonce:n}=window.umh_wp_data||{apiUrl:"",nonce:""},s=(0,l.useCallback)(async(e,t="GET",l=null)=>{a(!0);try{const a={method:t,headers:{"Content-Type":"application/json","X-WP-Nonce":n},body:l?JSON.stringify(l):null};let s=`${r}${e}`;"GET"===t&&l&&(s+="?"+new URLSearchParams(l).toString(),delete a.body);const c=await fetch(s,a),m=await c.json();if(!c.ok)throw new Error(m.message||"Error Request");return m}catch(e){throw console.error(e),e}finally{a(!1)}},[r,n]);return(0,l.createElement)(p.Provider,{value:{loading:t,apiCall:s,createOrUpdate:(e,t,a=null)=>a?s(`/${e}/${a}`,"PUT",t):s(`/${e}`,"POST",t),deleteItem:(e,t)=>s(`/${e}/${t}`,"DELETE"),getDashboardStats:()=>s("/stats/dashboard"),getEmployees:()=>s("/hr/employees"),submitBulkAttendance:e=>s("/hr/attendance/bulk","POST",e),requestKasbon:e=>s("/hr/kasbon","POST",e),getPayrollPreview:(e,t)=>s(`/hr/payroll/preview/${e}`,"GET",{month:t}),getTasks:e=>s("/tasks","GET",{user_id:e}),createTask:e=>s("/tasks","POST",e),updateTaskStatus:(e,t)=>s(`/tasks/${e}`,"PUT",{status:t}),submitWorkReport:e=>s("/reports","POST",e)}},e)},x=({size:e="md",color:t="blue"})=>(0,l.createElement)("svg",{className:`animate-spin ${{sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12",xl:"h-16 w-16"}[e]} ${{blue:"text-blue-600",white:"text-white",gray:"text-gray-600"}[t]}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},(0,l.createElement)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.createElement)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),y=({text:e="Memuat data..."})=>(0,l.createElement)("div",{className:"flex flex-col items-center justify-center p-10 h-64 w-full"},(0,l.createElement)(x,{size:"lg",color:"blue"}),(0,l.createElement)("p",{className:"mt-4 text-gray-500 font-medium animate-pulse"},e)),E=({title:e,value:t,icon:a,color:r})=>{const n={blue:"bg-blue-500",green:"bg-green-500",yellow:"bg-yellow-500",indigo:"bg-indigo-500",red:"bg-red-500",gray:"bg-gray-500"}[r]||"bg-blue-500";return(0,l.createElement)("div",{className:"bg-white overflow-hidden shadow rounded-lg"},(0,l.createElement)("div",{className:"p-5"},(0,l.createElement)("div",{className:"flex items-center"},(0,l.createElement)("div",{className:"flex-shrink-0"},(0,l.createElement)("div",{className:`rounded-md p-3 ${n} text-white flex items-center justify-center h-12 w-12`},(0,l.createElement)("span",{className:"text-2xl leading-none"},a))),(0,l.createElement)("div",{className:"ml-5 w-0 flex-1"},(0,l.createElement)("dl",null,(0,l.createElement)("dt",{className:"text-sm font-medium text-gray-500 truncate uppercase"},e),(0,l.createElement)("dd",null,(0,l.createElement)("div",{className:"text-lg font-bold text-gray-900"},t)))))))},h=()=>{const{getDashboardStats:e,apiCall:t,loading:a}=g(),{currentUser:r}=u(),[n,s]=(0,l.useState)(null),[c,m]=(0,l.useState)("");return(0,l.useEffect)(()=>{e().then(e=>s(e)).catch(console.error)},[]),a||!n?(0,l.createElement)(y,{text:"Memuat data dashboard..."}):(0,l.createElement)("div",{className:"p-6 space-y-8"},(0,l.createElement)("h1",{className:"text-3xl font-bold text-gray-800"},"Dashboard"),("owner"===r?.role||"administrator"===r?.role)&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6"},(0,l.createElement)(E,{title:"Total Jamaah",value:n.cards.total_jamaah,icon:"ðŸ‘¥",color:"blue"}),(0,l.createElement)(E,{title:"Pendaftar Bulan Ini",value:n.cards.new_jamaah_month,icon:"ðŸ“…",color:"green"}),(0,l.createElement)(E,{title:"Omset",value:`Rp ${n.cards.revenue?.toLocaleString()}`,icon:"ðŸ’°",color:"yellow"}),(0,l.createElement)(E,{title:"Profit Estimasi",value:`Rp ${n.cards.profit?.toLocaleString()}`,icon:"ðŸ“ˆ",color:"indigo"})),(0,l.createElement)("div",{className:"bg-white p-6 rounded-lg shadow"},(0,l.createElement)("h3",{className:"text-lg font-bold mb-4"},"Tren Pendaftaran (6 Bulan)"),(0,l.createElement)("div",{className:"flex items-end space-x-2 h-40"},n.chart?.map((e,t)=>(0,l.createElement)("div",{key:t,className:"bg-blue-500 w-full rounded-t hover:bg-blue-600 transition",style:{height:10*e.count+"%"},title:`${e.month}: ${e.count} Jamaah`}))),(0,l.createElement)("div",{className:"flex justify-between mt-2 text-xs text-gray-500"},n.chart?.map((e,t)=>(0,l.createElement)("span",{key:t},e.month))))),(0,l.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},(0,l.createElement)("div",{className:"bg-white p-6 rounded-lg shadow"},(0,l.createElement)("h3",{className:"text-lg font-bold mb-4"},"Tugas Saya Hari Ini"),n.my_tasks&&n.my_tasks.length>0?(0,l.createElement)("ul",{className:"space-y-3"},n.my_tasks.map(e=>(0,l.createElement)("li",{key:e.id,className:"p-3 border rounded-lg flex justify-between items-center"},(0,l.createElement)("div",null,(0,l.createElement)("p",{className:"font-bold"},e.title),(0,l.createElement)("p",{className:"text-sm text-gray-500"},e.description)),(0,l.createElement)("span",{className:"px-2 py-1 text-xs rounded "+("high"===e.priority?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800")},e.status)))):(0,l.createElement)("p",{className:"text-gray-500"},"Tidak ada tugas aktif.")),(0,l.createElement)("div",{className:"bg-white p-6 rounded-lg shadow"},(0,l.createElement)("h3",{className:"text-lg font-bold mb-4"},"Lapor Pekerjaan Harian"),(0,l.createElement)("form",{onSubmit:async e=>{e.preventDefault();try{await t("/hr/work-report","POST",{content:c}),alert("Laporan berhasil dikirim!"),m("")}catch(e){alert("Gagal kirim laporan")}}},(0,l.createElement)("textarea",{className:"w-full p-3 border rounded-lg mb-3",rows:"4",placeholder:"Apa yang Anda kerjakan hari ini?",value:c,onChange:e=>m(e.target.value),required:!0}),(0,l.createElement)("button",{type:"submit",className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 w-full"},"Kirim Laporan")))))},f=({mode:e="operational",onSuccess:t,onCancel:a})=>{const{createCashTransaction:r,createPayment:n,getJamaahList:s}=g(),[c,m]=(0,l.useState)(!1),[i,o]=(0,l.useState)([]),[d,u]=(0,l.useState)(""),[p,b]=(0,l.useState)({type:"operational"===e?"out":"in",category:"",amount:"",transaction_date:(new Date).toISOString().split("T")[0],description:"",proof_file:"",jamaah_id:"",payment_method:"Transfer"});(0,l.useEffect)(()=>{"payment"===e&&s({payment_status:"unpaid_partial"}).then(e=>o(e||[])).catch(console.error)},[e]);const x=i.filter(e=>e.full_name.toLowerCase().includes(d.toLowerCase())||e.passport_number&&e.passport_number.includes(d));return c?(0,l.createElement)(y,{text:"Menyimpan Transaksi..."}):(0,l.createElement)("form",{onSubmit:async a=>{a.preventDefault(),m(!0);try{"operational"===e?await r(p):await n({jamaah_id:p.jamaah_id,amount:p.amount,payment_date:p.transaction_date,payment_method:p.payment_method,proof_file:p.proof_file,notes:p.description}),t()}catch(e){alert("Gagal: "+e.message)}finally{m(!1)}},className:"space-y-4 bg-white p-6 rounded"},(0,l.createElement)("h3",{className:"text-lg font-bold mb-4 border-b pb-2"},"operational"===e?"Catat Kas Operasional":"Input Pembayaran Jamaah"),"payment"===e&&(0,l.createElement)("div",{className:"bg-blue-50 p-3 rounded border border-blue-200 mb-4"},(0,l.createElement)("label",{className:"label"},"Cari Jamaah"),(0,l.createElement)("input",{type:"text",placeholder:"Ketik Nama / No Paspor...",className:"input-field w-full mb-2",value:d,onChange:e=>u(e.target.value)}),(0,l.createElement)("select",{className:"input-field w-full font-bold text-blue-800",value:p.jamaah_id,onChange:e=>b({...p,jamaah_id:e.target.value}),required:!0,size:5},x.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id,className:"p-2 border-b hover:bg-blue-100"},e.full_name," - ",e.package_name," (Sisa Tagihan: ",new Intl.NumberFormat("id-ID").format(e.remaining_payment),")"))),p.jamaah_id&&(0,l.createElement)("p",{className:"text-xs text-green-600 mt-1"},"Jamaah Terpilih âœ…")),"operational"===e&&(0,l.createElement)("div",{className:"grid grid-cols-2 gap-4"},(0,l.createElement)("label",{className:"cursor-pointer border p-3 rounded text-center "+("in"===p.type?"bg-green-100 border-green-500 text-green-800 font-bold":"bg-gray-50")},(0,l.createElement)("input",{type:"radio",name:"type",value:"in",checked:"in"===p.type,onChange:()=>b({...p,type:"in"}),className:"hidden"}),"â¬‡ Kas Masuk"),(0,l.createElement)("label",{className:"cursor-pointer border p-3 rounded text-center "+("out"===p.type?"bg-red-100 border-red-500 text-red-800 font-bold":"bg-gray-50")},(0,l.createElement)("input",{type:"radio",name:"type",value:"out",checked:"out"===p.type,onChange:()=>b({...p,type:"out"}),className:"hidden"}),"â¬† Kas Keluar")),(0,l.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Tanggal Transaksi"),(0,l.createElement)("input",{type:"date",className:"input-field w-full",value:p.transaction_date,onChange:e=>b({...p,transaction_date:e.target.value}),required:!0})),(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Nominal (Rp)"),(0,l.createElement)("input",{type:"number",className:"input-field w-full text-right font-mono font-bold",placeholder:"0",value:p.amount,onChange:e=>b({...p,amount:e.target.value}),required:!0}))),"operational"===e?(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Kategori"),(0,l.createElement)("input",{type:"text",placeholder:"Contoh: Listrik, Konsumsi, Hotel...",className:"input-field w-full",value:p.category,onChange:e=>b({...p,category:e.target.value}),required:!0})):(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Metode Pembayaran"),(0,l.createElement)("select",{className:"input-field w-full",value:p.payment_method,onChange:e=>b({...p,payment_method:e.target.value})},(0,l.createElement)("option",{value:"Transfer"},"Transfer Bank"),(0,l.createElement)("option",{value:"Tunai"},"Tunai / Cash"),(0,l.createElement)("option",{value:"EDC"},"Kartu Debit/Kredit"))),(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Keterangan / Catatan"),(0,l.createElement)("textarea",{className:"input-field w-full",rows:"2",value:p.description,onChange:e=>b({...p,description:e.target.value}),required:!0})),(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Link Bukti (URL Gambar)"),(0,l.createElement)("input",{type:"text",placeholder:"https://...",className:"input-field w-full",value:p.proof_file,onChange:e=>b({...p,proof_file:e.target.value})})),(0,l.createElement)("div",{className:"flex justify-end space-x-2 pt-4 border-t mt-2"},(0,l.createElement)("button",{type:"button",onClick:a,className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300"},"Batal"),(0,l.createElement)("button",{type:"submit",className:"px-6 py-2 rounded bg-blue-600 text-white font-bold hover:bg-blue-700"},"Simpan")))};var v={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},N=l.createContext&&l.createContext(v),w=["attr","size","title"];function k(){return k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},k.apply(this,arguments)}function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,l)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach(function(t){var l,r,n,s;l=e,r=t,n=a[t],(r="symbol"==typeof(s=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r))?s:s+"")in l?Object.defineProperty(l,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):l[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function S(e){return e&&e.map((e,t)=>l.createElement(e.tag,C({key:t},e.attr),S(e.child)))}function P(e){return t=>l.createElement(j,k({attr:C({},e.attr)},t),S(e.child))}function j(e){var t=t=>{var a,{attr:r,size:n,title:s}=e,c=function(e,t){if(null==e)return{};var a,l,r=function(e,t){if(null==e)return{};var a={};for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){if(t.indexOf(l)>=0)continue;a[l]=e[l]}return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(l=0;l<n.length;l++)a=n[l],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}(e,w),m=n||t.size||"1em";return t.className&&(a=t.className),e.className&&(a=(a?a+" ":"")+e.className),l.createElement("svg",k({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,c,{className:a,style:C(C({color:e.color||t.color},t.style),e.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),s&&l.createElement("title",null,s),e.children)};return void 0!==N?l.createElement(N.Consumer,null,e=>t(e)):t(v)}function D(e){return P({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"},child:[]}]})(e)}function T(e){return P({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M509.5 184.6L458.9 32.8C452.4 13.2 434.1 0 413.4 0H272v192h238.7c-.4-2.5-.4-5-1.2-7.4zM240 0H98.6c-20.7 0-39 13.2-45.5 32.8L2.5 184.6c-.8 2.4-.8 4.9-1.2 7.4H240V0zM0 224v240c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V224H0z"},child:[]}]})(e)}function L(e){return P({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M576 240c0-23.63-12.95-44.04-32-55.12V32.01C544 23.26 537.02 0 512 0c-7.12 0-14.19 2.38-19.98 7.02l-85.03 68.03C364.28 109.19 310.66 128 256 128H64c-35.35 0-64 28.65-64 64v96c0 35.35 28.65 64 64 64h33.7c-1.39 10.48-2.18 21.14-2.18 32 0 39.77 9.26 77.35 25.56 110.94 5.19 10.69 16.52 17.06 28.4 17.06h74.28c26.05 0 41.69-29.84 25.9-50.56-16.4-21.52-26.15-48.36-26.15-77.44 0-11.11 1.62-21.79 4.41-32H256c54.66 0 108.28 18.81 150.98 52.95l85.03 68.03a32.023 32.023 0 0 0 19.98 7.02c24.92 0 32-22.78 32-32V295.13C563.05 284.04 576 263.63 576 240zm-96 141.42l-33.05-26.44C392.95 311.78 325.12 288 256 288v-96c69.12 0 136.95-23.78 190.95-66.98L480 98.58v282.84z"},child:[]}]})(e)}function O(e){return P({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"},child:[]}]})(e)}function M(e){return P({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function z(e){return P({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function B(e){return P({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 176c-44.19 0-80-42.99-80-96 0-53.02 35.82-96 80-96s80 42.98 80 96c0 53.03-35.83 96-80 96zm272 48h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function I(e){return P({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function K(e){return P({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function A(e){return P({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm95.8 32.6L272 480l-32-136 32-56h-96l32 56-32 136-47.8-191.4C56.9 292 0 350.3 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-72.1-56.9-130.4-128.2-133.8z"},child:[]}]})(e)}function H(e){return P({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const U=({isOpen:e,onClose:t,title:a,children:r,size:n="md",noPadding:s=!1})=>((0,l.useEffect)(()=>{const a=e=>{"Escape"===e.key&&t()};return e&&window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[e,t]),e?(0,l.createElement)("div",{className:"fixed inset-0 z-50 overflow-y-auto"},(0,l.createElement)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),(0,l.createElement)("div",{className:"flex items-center justify-center min-h-screen p-4"},(0,l.createElement)("div",{className:`relative bg-white rounded-xl shadow-2xl w-full transform transition-all ${{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-full mx-4"}[n]}`,onClick:e=>e.stopPropagation()},(0,l.createElement)("div",{className:"flex justify-between items-center p-5 border-b border-gray-100"},(0,l.createElement)("h3",{className:"text-xl font-bold text-gray-800"},a),(0,l.createElement)("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors p-1 rounded-full hover:bg-red-50"},(0,l.createElement)(I,null))),(0,l.createElement)("div",{className:s?"":"p-6"},r)))):null),$=()=>{const{getFinanceStats:e,getCashFlow:t,getPayments:a}=g(),[r,n]=(0,l.useState)({total_in:0,total_out:0,balance:0}),[s,c]=(0,l.useState)([]),[m,i]=(0,l.useState)([]),[o,d]=(0,l.useState)("cashflow"),[u,p]=(0,l.useState)(!0),[b,x]=(0,l.useState)(!1),[E,h]=(0,l.useState)("operational");(0,l.useEffect)(()=>{v()},[o]);const v=async()=>{p(!0);try{const l=await e();if(n(l||{total_in:0,total_out:0,balance:0}),"cashflow"===o){const e=await t();c(e||[])}else{const e=await a();i(e||[])}}catch(e){console.error("Error finance data",e)}finally{p(!1)}},N=e=>{h(e),x(!0)},w=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}).format(e);return(0,l.createElement)("div",{className:"p-6"},(0,l.createElement)("h1",{className:"text-2xl font-bold text-gray-800 mb-6"},"Keuangan & Kas"),(0,l.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},(0,l.createElement)("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200 shadow-sm"},(0,l.createElement)("div",{className:"text-sm text-green-600 font-bold uppercase"},"Total Pemasukan"),(0,l.createElement)("div",{className:"text-2xl font-bold text-green-800"},w(r.total_in))),(0,l.createElement)("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200 shadow-sm"},(0,l.createElement)("div",{className:"text-sm text-red-600 font-bold uppercase"},"Total Pengeluaran"),(0,l.createElement)("div",{className:"text-2xl font-bold text-red-800"},w(r.total_out))),(0,l.createElement)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200 shadow-sm"},(0,l.createElement)("div",{className:"text-sm text-blue-600 font-bold uppercase"},"Saldo Kas Saat Ini"),(0,l.createElement)("div",{className:"text-3xl font-bold text-blue-800"},w(r.balance)))),(0,l.createElement)("div",{className:"flex justify-between items-center mb-4"},(0,l.createElement)("div",{className:"flex space-x-4"},(0,l.createElement)("button",{onClick:()=>d("cashflow"),className:"px-4 py-2 font-medium rounded-t-lg "+("cashflow"===o?"bg-white text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700")},"Arus Kas (Cash Flow)"),(0,l.createElement)("button",{onClick:()=>d("payments"),className:"px-4 py-2 font-medium rounded-t-lg "+("payments"===o?"bg-white text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700")},"Riwayat Pembayaran Jamaah")),(0,l.createElement)("div",{className:"space-x-2"},(0,l.createElement)("button",{onClick:()=>N("operational"),className:"bg-gray-800 text-white px-4 py-2 rounded hover:bg-gray-700 text-sm"},"+ Kas Operasional"),(0,l.createElement)("button",{onClick:()=>N("payment"),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 text-sm shadow"},"+ Input Pembayaran Jamaah"))),(0,l.createElement)("div",{className:"bg-white rounded shadow overflow-hidden min-h-[300px]"},u?(0,l.createElement)(y,null):(0,l.createElement)(l.Fragment,null,"cashflow"===o&&(0,l.createElement)("table",{className:"min-w-full divide-y divide-gray-200"},(0,l.createElement)("thead",{className:"bg-gray-50"},(0,l.createElement)("tr",null,(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase"},"Tanggal"),(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase"},"Kategori"),(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase"},"Deskripsi"),(0,l.createElement)("th",{className:"px-6 py-3 text-right text-xs font-bold text-gray-500 uppercase"},"Nominal"))),(0,l.createElement)("tbody",{className:"divide-y divide-gray-200"},s.map(e=>(0,l.createElement)("tr",{key:e.id,className:"hover:bg-gray-50"},(0,l.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},e.transaction_date),(0,l.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},(0,l.createElement)("span",{className:"px-2 py-1 rounded text-xs font-bold "+("in"===e.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800")},"in"===e.type?"MASUK":"KELUAR"),(0,l.createElement)("span",{className:"ml-2"},e.category)),(0,l.createElement)("td",{className:"px-6 py-4 text-sm text-gray-600"},e.description),(0,l.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-bold "+("in"===e.type?"text-green-600":"text-red-600")},"in"===e.type?"+":"-"," ",w(e.amount)))),0===s.length&&(0,l.createElement)("tr",null,(0,l.createElement)("td",{colSpan:"4",className:"p-6 text-center text-gray-500"},"Belum ada transaksi")))),"payments"===o&&(0,l.createElement)("table",{className:"min-w-full divide-y divide-gray-200"},(0,l.createElement)("thead",{className:"bg-gray-50"},(0,l.createElement)("tr",null,(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase"},"Tanggal"),(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase"},"Jamaah"),(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase"},"Metode"),(0,l.createElement)("th",{className:"px-6 py-3 text-right text-xs font-bold text-gray-500 uppercase"},"Jumlah"))),(0,l.createElement)("tbody",{className:"divide-y divide-gray-200"},m.map(e=>(0,l.createElement)("tr",{key:e.id,className:"hover:bg-gray-50"},(0,l.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},e.payment_date),(0,l.createElement)("td",{className:"px-6 py-4 whitespace-nowrap"},(0,l.createElement)("div",{className:"text-sm font-bold text-gray-900"},e.full_name),(0,l.createElement)("div",{className:"text-xs text-gray-500"},"Paspor: ",e.passport_number||"-")),(0,l.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},e.payment_method),(0,l.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-bold text-green-600"},w(e.amount)))),0===m.length&&(0,l.createElement)("tr",null,(0,l.createElement)("td",{colSpan:"4",className:"p-6 text-center text-gray-500"},"Belum ada data pembayaran")))))),b&&(0,l.createElement)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4"},(0,l.createElement)("div",{className:"w-full max-w-2xl"},(0,l.createElement)(f,{mode:E,onSuccess:()=>{x(!1),v()},onCancel:()=>x(!1)}))))},R=({children:e,variant:t="primary",className:a="",type:r="button",...n})=>{const s={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",warning:"bg-yellow-500 text-white hover:bg-yellow-600 focus:ring-yellow-500",icon:"p-2 text-gray-500 hover:bg-gray-100 rounded-full shadow-none border-none"};return(0,l.createElement)("button",{type:r,className:`px-4 py-2 rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ${s[t]||s.primary} ${a}`,...n},e)},J=({label:e,className:t="",error:a,...r})=>(0,l.createElement)("div",{className:"w-full"},e&&(0,l.createElement)("label",{className:"block text-sm font-medium text-gray-700 mb-1"},e),(0,l.createElement)("input",{className:`w-full px-3 py-2 border ${a?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${t}`,...r}),a&&(0,l.createElement)("p",{className:"mt-1 text-xs text-red-500"},a)),F=({label:e,className:t="",error:a,...r})=>(0,l.createElement)("div",{className:"w-full"},e&&(0,l.createElement)("label",{className:"block text-sm font-medium text-gray-700 mb-1"},e),(0,l.createElement)("textarea",{className:`w-full px-3 py-2 border ${a?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${t}`,...r}),a&&(0,l.createElement)("p",{className:"mt-1 text-xs text-red-500"},a)),q=({label:e,children:t,className:a="",error:r,...n})=>(0,l.createElement)("div",{className:"w-full"},e&&(0,l.createElement)("label",{className:"block text-sm font-medium text-gray-700 mb-1"},e),(0,l.createElement)("select",{className:`w-full px-3 py-2 border ${r?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${a}`,...n},t),r&&(0,l.createElement)("p",{className:"mt-1 text-xs text-red-500"},r)),V=({data:e,onClose:t})=>{const{createOrUpdate:a}=g(),[r,n]=(0,l.useState)(!1),[s,c]=(0,l.useState)({name:e?.name||"",email:e?.email||"",phone:e?.phone||"",source:e?.source||"social_media",status:e?.status||"new",notes:e?.notes||""}),m=e=>c(t=>({...t,[e.target.name]:e.target.value}));return(0,l.createElement)("form",{onSubmit:async l=>{l.preventDefault(),n(!0);try{await a("marketing",s,e?.id),t()}catch(e){alert(e.message)}finally{n(!1)}},className:"space-y-4 p-2"},(0,l.createElement)(J,{label:"Nama Prospek",name:"name",value:s.name,onChange:m,required:!0}),(0,l.createElement)("div",{className:"grid grid-cols-2 gap-4"},(0,l.createElement)(J,{label:"No. WhatsApp",name:"phone",value:s.phone,onChange:m,required:!0}),(0,l.createElement)(J,{label:"Email",type:"email",name:"email",value:s.email,onChange:m})),(0,l.createElement)("div",{className:"grid grid-cols-2 gap-4"},(0,l.createElement)(q,{label:"Sumber",name:"source",value:s.source,onChange:m},(0,l.createElement)("option",{value:"social_media"},"Media Sosial (IG/FB)"),(0,l.createElement)("option",{value:"website"},"Website"),(0,l.createElement)("option",{value:"referral"},"Referral / Teman"),(0,l.createElement)("option",{value:"walk_in"},"Datang Langsung"),(0,l.createElement)("option",{value:"agent"},"Agen")),(0,l.createElement)(q,{label:"Status Lead",name:"status",value:s.status,onChange:m},(0,l.createElement)("option",{value:"new"},"Baru"),(0,l.createElement)("option",{value:"contacted"},"Sudah Dihubungi"),(0,l.createElement)("option",{value:"qualified"},"Potensial (Qualified)"),(0,l.createElement)("option",{value:"lost"},"Batal / Lost"),(0,l.createElement)("option",{value:"converted"},"Closing (Jadi Jemaah)"))),(0,l.createElement)(F,{label:"Catatan Tambahan",name:"notes",value:s.notes,onChange:m,rows:3}),(0,l.createElement)("div",{className:"flex justify-end gap-2 pt-4"},(0,l.createElement)(R,{type:"button",variant:"secondary",onClick:t},"Batal"),(0,l.createElement)(R,{type:"submit",disabled:r},r?"Simpan...":"Simpan Lead")))},G=()=>{const{getLeads:e}=g(),[t,a]=(0,l.useState)([]),[r,n]=(0,l.useState)(!1);(0,l.useEffect)(()=>{s()},[]);const s=()=>{e().then(e=>a(e||[])).catch(console.error)};return(0,l.createElement)("div",{className:"p-6"},(0,l.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,l.createElement)("h1",{className:"text-2xl font-bold"},"Marketing Leads"),(0,l.createElement)("button",{onClick:()=>n(!0),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"+ Tambah Lead")),(0,l.createElement)("div",{className:"bg-white rounded shadow overflow-hidden"},(0,l.createElement)("table",{className:"min-w-full"},(0,l.createElement)("thead",{className:"bg-gray-50"},(0,l.createElement)("tr",null,(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Nama"),(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Kontak"),(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Status"))),(0,l.createElement)("tbody",{className:"divide-y divide-gray-200"},t.map(e=>(0,l.createElement)("tr",{key:e.id},(0,l.createElement)("td",{className:"px-6 py-4"},e.name),(0,l.createElement)("td",{className:"px-6 py-4"},e.phone),(0,l.createElement)("td",{className:"px-6 py-4"},(0,l.createElement)("span",{className:"px-2 py-1 rounded text-xs "+("new"===e.status?"bg-blue-100":"bg-green-100")},e.status))))))),(0,l.createElement)(U,{isOpen:r,onClose:()=>n(!1),title:"Tambah Lead Baru"},(0,l.createElement)(V,{onSuccess:()=>{n(!1),s()},onCancel:()=>n(!1)})))},Q=()=>{const{apiCall:e,loading:t}=g(),[a,r]=(0,l.useState)("staff"),[n,s]=(0,l.useState)([]),[c,m]=(0,l.useState)([]);return(0,l.useEffect)(()=>{"staff"!==a&&"attendance"!==a||e("/hr/employees").then(e=>s(e||[])),"payroll"===a&&e("/hr/payroll").then(e=>m(e||[]))},[a]),(0,l.createElement)("div",{className:"p-6"},(0,l.createElement)("h1",{className:"text-2xl font-bold mb-6"},"Manajemen HR"),(0,l.createElement)("div",{className:"flex space-x-4 mb-6 border-b"},(0,l.createElement)("button",{onClick:()=>r("staff"),className:"pb-2 px-4 "+("staff"===a?"border-b-2 border-blue-600 text-blue-600":"text-gray-500")},"Data Karyawan"),(0,l.createElement)("button",{onClick:()=>r("attendance"),className:"pb-2 px-4 "+("attendance"===a?"border-b-2 border-blue-600 text-blue-600":"text-gray-500")},"Absensi Harian"),(0,l.createElement)("button",{onClick:()=>r("payroll"),className:"pb-2 px-4 "+("payroll"===a?"border-b-2 border-blue-600 text-blue-600":"text-gray-500")},"Gaji & Kasbon")),t?(0,l.createElement)(y,null):(0,l.createElement)(l.Fragment,null,"attendance"===a&&(0,l.createElement)("form",{onSubmit:async t=>{t.preventDefault();const a=t.target,l=n.map(e=>({id:e.id,status:a[`status_${e.id}`].value}));try{await e("/hr/attendance","POST",{date:(new Date).toISOString().split("T")[0],employees:l}),alert("Absensi tersimpan!")}catch(e){alert("Gagal simpan absensi")}},className:"bg-white p-6 rounded shadow"},(0,l.createElement)("h3",{className:"font-bold mb-4"},"Absensi Hari Ini (",(new Date).toLocaleDateString(),")"),(0,l.createElement)("table",{className:"w-full"},(0,l.createElement)("thead",null,(0,l.createElement)("tr",{className:"text-left border-b"},(0,l.createElement)("th",{className:"p-2"},"Nama"),(0,l.createElement)("th",{className:"p-2"},"Status"))),(0,l.createElement)("tbody",null,n.map(e=>(0,l.createElement)("tr",{key:e.id,className:"border-b"},(0,l.createElement)("td",{className:"p-2"},e.display_name),(0,l.createElement)("td",{className:"p-2"},(0,l.createElement)("select",{name:`status_${e.id}`,className:"border p-1 rounded"},(0,l.createElement)("option",{value:"present"},"Hadir (Checklist)"),(0,l.createElement)("option",{value:"absent"},"Alpha/Absen"),(0,l.createElement)("option",{value:"sick"},"Sakit"),(0,l.createElement)("option",{value:"permission"},"Izin"))))))),(0,l.createElement)("button",{className:"mt-4 bg-blue-600 text-white px-4 py-2 rounded"},"Simpan Absensi")),"payroll"===a&&(0,l.createElement)("div",{className:"bg-white p-6 rounded shadow"},(0,l.createElement)("h3",{className:"font-bold mb-4"},"Estimasi Gaji Bulan Ini"),(0,l.createElement)("table",{className:"w-full text-sm"},(0,l.createElement)("thead",{className:"bg-gray-50"},(0,l.createElement)("tr",null,(0,l.createElement)("th",{className:"p-3 text-left"},"Nama"),(0,l.createElement)("th",{className:"p-3 text-right"},"Gaji Pokok"),(0,l.createElement)("th",{className:"p-3 text-right"},"Potongan Absen"),(0,l.createElement)("th",{className:"p-3 text-right"},"Potongan Kasbon"),(0,l.createElement)("th",{className:"p-3 text-right"},"Total Terima"))),(0,l.createElement)("tbody",null,c.map((e,t)=>(0,l.createElement)("tr",{key:t,className:"border-b"},(0,l.createElement)("td",{className:"p-3"},e.name),(0,l.createElement)("td",{className:"p-3 text-right"},parseInt(e.basic).toLocaleString()),(0,l.createElement)("td",{className:"p-3 text-right text-red-500"},"-",e.absent_deduction.toLocaleString()," (",e.absent_days," hari)"),(0,l.createElement)("td",{className:"p-3 text-right text-red-500"},"-",e.cashbond.toLocaleString()),(0,l.createElement)("td",{className:"p-3 text-right font-bold text-green-600"},e.net_salary.toLocaleString())))))),"staff"===a&&(0,l.createElement)("div",{className:"text-center text-gray-500 py-10"},'Gunakan tombol "Tambah Pegawai" di pojok kanan atas untuk menambah data (Fitur sudah ada sebelumnya).')))},W=({initialData:e,onSuccess:t,onCancel:a})=>{const{createJamaah:r,updateJamaah:n,getPackages:s}=g(),[c,m]=(0,l.useState)([]),[i,o]=(0,l.useState)([]),[d,u]=(0,l.useState)([]),[p,b]=(0,l.useState)(!1),[x,y]=(0,l.useState)({full_name:"",package_id:"",passport_number:"",phone_number:"",address_details:{provinsi_id:"",provinsi_name:"",kota_id:"",kota_name:"",detail_alamat:""},...e});(0,l.useEffect)(()=>{s({status:"active"}).then(e=>m(e||[])),fetch("https://www.emsifa.com/api-wilayah-indonesia/api/provinces.json").then(e=>e.json()).then(e=>o(e)).catch(e=>console.error("Gagal ambil provinsi",e)),e?.address_details?.provinsi_id&&E(e.address_details.provinsi_id)},[e]);const E=e=>{fetch(`https://www.emsifa.com/api-wilayah-indonesia/api/regencies/${e}.json`).then(e=>e.json()).then(e=>u(e))};return(0,l.createElement)("form",{onSubmit:async a=>{a.preventDefault(),b(!0);try{e?.id?await n(e.id,x):await r(x),t()}catch(e){alert("Error: "+e.message)}finally{b(!1)}},className:"bg-white p-6 rounded shadow space-y-4"},(0,l.createElement)("h2",{className:"text-xl font-bold text-gray-800 mb-4"},e?"Edit Jamaah":"Daftar Jamaah Baru"),(0,l.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Nama Lengkap"),(0,l.createElement)("input",{type:"text",required:!0,className:"input-field",value:x.full_name,onChange:e=>y({...x,full_name:e.target.value})})),(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Paket"),(0,l.createElement)("select",{required:!0,className:"input-field",value:x.package_id,onChange:e=>y({...x,package_id:e.target.value})},(0,l.createElement)("option",{value:""},"Pilih Paket"),c.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id},e.name))))),(0,l.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Provinsi"),(0,l.createElement)("select",{className:"input-field",onChange:e=>{const t=e.target.value,a=e.target.options[e.target.selectedIndex].text;y(e=>({...e,address_details:{...e.address_details,provinsi_id:t,provinsi_name:a,kota_id:""}})),E(t)},value:x.address_details?.provinsi_id},(0,l.createElement)("option",{value:""},"Pilih Provinsi"),i.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id},e.name)))),(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Kota/Kabupaten"),(0,l.createElement)("select",{className:"input-field",onChange:e=>y({...x,address_details:{...x.address_details,kota_id:e.target.value,kota_name:e.target.options[e.target.selectedIndex].text}}),value:x.address_details?.kota_id},(0,l.createElement)("option",{value:""},"Pilih Kota"),d.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id},e.name))))),(0,l.createElement)("div",{className:"flex justify-end gap-2 pt-4"},(0,l.createElement)("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-200 rounded"},"Batal"),(0,l.createElement)("button",{type:"submit",disabled:p,className:"px-4 py-2 bg-blue-600 text-white rounded"},p?"Menyimpan...":"Simpan")))},Y=()=>{const{getJamaahList:e,deleteJamaah:t,getPackages:a,loading:r}=g(),[n,s]=(0,l.useState)([]),[c,m]=(0,l.useState)([]),[i,o]=(0,l.useState)({search:"",package_id:"",payment_status:"",month:""}),[d,u]=(0,l.useState)(!1),[p,b]=(0,l.useState)(null);(0,l.useEffect)(()=>{x()},[]),(0,l.useEffect)(()=>{const e=setTimeout(()=>{E()},500);return()=>clearTimeout(e)},[i]);const x=async()=>{try{const e=await a({status:"active"});m(e||[]),E()}catch(e){console.error(e)}},E=async()=>{try{const t=await e(i);s(t||[])}catch(e){console.error(e)}},h=()=>{u(!1),b(null),E()};return(0,l.createElement)("div",{className:"p-6"},(0,l.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,l.createElement)("h1",{className:"text-2xl font-bold text-gray-800"},"Data Jamaah"),(0,l.createElement)("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition shadow"},"+ Input Jamaah Baru")),(0,l.createElement)("div",{className:"bg-white p-4 rounded shadow mb-6 grid grid-cols-1 md:grid-cols-4 gap-4"},(0,l.createElement)("input",{type:"text",placeholder:"Cari Nama / No Paspor...",className:"border p-2 rounded w-full",value:i.search,onChange:e=>o({...i,search:e.target.value})}),(0,l.createElement)("select",{className:"border p-2 rounded w-full",value:i.package_id,onChange:e=>o({...i,package_id:e.target.value})},(0,l.createElement)("option",{value:""},"Semua Paket"),c.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id},e.name))),(0,l.createElement)("select",{className:"border p-2 rounded w-full",value:i.payment_status,onChange:e=>o({...i,payment_status:e.target.value})},(0,l.createElement)("option",{value:""},"Status Pembayaran"),(0,l.createElement)("option",{value:"lunas"},"Lunas"),(0,l.createElement)("option",{value:"partial"},"Belum Lunas (Partial)"),(0,l.createElement)("option",{value:"unpaid"},"Belum Bayar")),(0,l.createElement)("input",{type:"month",className:"border p-2 rounded w-full",value:i.month,onChange:e=>o({...i,month:e.target.value})})),r&&0===n.length?(0,l.createElement)(y,null):(0,l.createElement)("div",{className:"bg-white rounded-lg shadow overflow-x-auto"},(0,l.createElement)("table",{className:"min-w-full divide-y divide-gray-200"},(0,l.createElement)("thead",{className:"bg-gray-50"},(0,l.createElement)("tr",null,(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Nama / Umur"),(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Paket / Keberangkatan"),(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Status Dokumen"),(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Pembayaran"),(0,l.createElement)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"Aksi"))),(0,l.createElement)("tbody",{className:"divide-y divide-gray-200"},0===n.length?(0,l.createElement)("tr",null,(0,l.createElement)("td",{colSpan:"5",className:"px-6 py-4 text-center text-gray-500"},"Tidak ada data jamaah.")):n.map(e=>{return(0,l.createElement)("tr",{key:e.id,className:"hover:bg-gray-50"},(0,l.createElement)("td",{className:"px-6 py-4"},(0,l.createElement)("div",{className:"text-sm font-medium text-gray-900"},e.full_name),(0,l.createElement)("div",{className:"text-xs text-gray-500"},"L"===e.gender?"Laki-laki":"Perempuan"," â€¢ ",e.age," Tahun"),(0,l.createElement)("div",{className:"text-xs text-blue-500 mt-1"},e.phone_number)),(0,l.createElement)("td",{className:"px-6 py-4"},(0,l.createElement)("div",{className:"text-sm text-gray-900 font-semibold"},e.package_name),(0,l.createElement)("div",{className:"text-xs text-gray-500"},"Kamar: ",e.selected_room_type),(0,l.createElement)("div",{className:"text-xs text-gray-500"},"PIC: ",e.pic_name||"-")),(0,l.createElement)("td",{className:"px-6 py-4"},(0,l.createElement)("div",{className:"flex space-x-1"},(0,l.createElement)("span",{title:"KTP",className:"w-3 h-3 rounded-full "+(e.document_status?.ktp?"bg-green-500":"bg-gray-300")}),(0,l.createElement)("span",{title:"KK",className:"w-3 h-3 rounded-full "+(e.document_status?.kk?"bg-green-500":"bg-gray-300")}),(0,l.createElement)("span",{title:"Paspor",className:"w-3 h-3 rounded-full "+(e.document_status?.passport?"bg-green-500":"bg-gray-300")}),(0,l.createElement)("span",{title:"Meningitis",className:"w-3 h-3 rounded-full "+(e.document_status?.meningitis?"bg-green-500":"bg-gray-300")})),(0,l.createElement)("div",{className:"text-xs text-gray-500 mt-1"},"Kit: ",(0,l.createElement)("span",{className:"capitalize font-bold "+("sent"===e.kit_status?"text-green-600":"text-yellow-600")},e.kit_status))),(0,l.createElement)("td",{className:"px-6 py-4"},(0,l.createElement)("div",{className:"text-xs inline-flex px-2 py-1 rounded-full font-bold "+("lunas"===e.payment_status?"bg-green-100 text-green-800":"partial"===e.payment_status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800")},"lunas"===e.payment_status?"LUNAS":"partial"===e.payment_status?"CICILAN":"BELUM BAYAR"),e.remaining_payment>0&&(0,l.createElement)("div",{className:"text-xs text-red-500 mt-1"},"Sisa: ",(a=e.remaining_payment,new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}).format(a)))),(0,l.createElement)("td",{className:"px-6 py-4 text-right text-sm font-medium space-x-2"},(0,l.createElement)("button",{onClick:()=>(b(e),void u(!0)),className:"text-blue-600 hover:text-blue-900"},"Edit"),(0,l.createElement)("button",{onClick:()=>(async e=>{if(confirm("Yakin hapus data jamaah ini?"))try{await t(e),E()}catch(e){alert(e.message)}})(e.id),className:"text-red-600 hover:text-red-900"},"Hapus")));var a})))),d&&(0,l.createElement)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4 overflow-y-auto"},(0,l.createElement)("div",{className:"bg-white rounded-lg w-full max-w-5xl max-h-full overflow-y-auto my-8"},(0,l.createElement)("div",{className:"p-6"},(0,l.createElement)(W,{initialData:p,onSuccess:h,onCancel:h})))))},X=({initialData:e,onSuccess:t,onCancel:a})=>{const{createPackage:r,updatePackage:n,getMasterData:s,getCategories:c}=g(),[m,i]=(0,l.useState)(!0),[o,d]=(0,l.useState)([]),[u,p]=(0,l.useState)([]),[b,x]=(0,l.useState)([]),[E,h]=(0,l.useState)({name:"",category_id:"",sub_category_id:"",departure_date:"",airline_id:"",status:"active",itinerary_file:"",hotels:[],pricing_variants:[{type:"Quad",price:0,currency:"IDR"},{type:"Triple",price:0,currency:"IDR"},{type:"Double",price:0,currency:"IDR"}]});(0,l.useEffect)(()=>{(async()=>{try{const[t,a,l]=await Promise.all([s("airline"),s("hotel"),c()]);d(t||[]),p(a||[]),x(l||[]),e&&h({...e,hotels:e.hotels||[],pricing_variants:e.pricing_variants||[]})}catch(e){console.error(e)}finally{i(!1)}})()},[e]);const f=e=>{const{name:t,value:a}=e.target;h(e=>({...e,[t]:a}))},v=(e,t,a)=>{const l=[...E.pricing_variants];l[e][t]=a,h(e=>({...e,pricing_variants:l}))},N=b.filter(e=>0==e.parent_id),w=b.filter(e=>e.parent_id==E.category_id);return m?(0,l.createElement)(y,{text:"Memuat Data Master..."}):(0,l.createElement)("form",{onSubmit:async a=>{a.preventDefault();try{e?.id?await n(e.id,E):await r(E),t()}catch(e){alert("Gagal menyimpan: "+e.message)}},className:"space-y-6 bg-white p-6 rounded shadow max-h-[80vh] overflow-y-auto"},(0,l.createElement)("h2",{className:"text-xl font-bold border-b pb-2 mb-4"},e?"Edit Paket":"Buat Paket Baru"),(0,l.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},(0,l.createElement)("div",{className:"space-y-4"},(0,l.createElement)("h3",{className:"font-semibold text-gray-700"},"Informasi Dasar"),(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Nama Paket"),(0,l.createElement)("input",{type:"text",name:"name",className:"input-field w-full border p-2 rounded",value:E.name,onChange:f,required:!0})),(0,l.createElement)("div",{className:"grid grid-cols-2 gap-2"},(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Kategori"),(0,l.createElement)("select",{name:"category_id",className:"input-field w-full border p-2 rounded",value:E.category_id,onChange:f,required:!0},(0,l.createElement)("option",{value:""},"Pilih Kategori"),N.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id},e.name)))),(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Sub Kategori"),(0,l.createElement)("select",{name:"sub_category_id",className:"input-field w-full border p-2 rounded",value:E.sub_category_id,onChange:f},(0,l.createElement)("option",{value:""},"Pilih Sub (Opsional)"),w.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id},e.name))))),(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Tanggal Keberangkatan"),(0,l.createElement)("input",{type:"date",name:"departure_date",className:"input-field w-full border p-2 rounded",value:E.departure_date,onChange:f,required:!0})),(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Maskapai"),(0,l.createElement)("select",{name:"airline_id",className:"input-field w-full border p-2 rounded",value:E.airline_id,onChange:f,required:!0},(0,l.createElement)("option",{value:""},"Pilih Maskapai"),o.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id},e.name)))),(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Status"),(0,l.createElement)("select",{name:"status",className:"input-field w-full border p-2 rounded",value:E.status,onChange:f},(0,l.createElement)("option",{value:"active"},"Aktif (Buka Pendaftaran)"),(0,l.createElement)("option",{value:"full"},"Penuh"),(0,l.createElement)("option",{value:"completed"},"Selesai"),(0,l.createElement)("option",{value:"cancelled"},"Dibatalkan"))),(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label"},"Link Itinerary (URL PDF/File)"),(0,l.createElement)("input",{type:"url",name:"itinerary_file",placeholder:"https://...",className:"input-field w-full border p-2 rounded",value:E.itinerary_file,onChange:f}))),(0,l.createElement)("div",{className:"space-y-4 border-l pl-6"},(0,l.createElement)("h3",{className:"font-semibold text-gray-700"},"Hotel & Harga"),(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"label mb-1 block"},"Pilih Hotel (Bisa Lebih dari 1)"),(0,l.createElement)("div",{className:"max-h-32 overflow-y-auto border rounded p-2 grid grid-cols-1 gap-1"},0===u.length&&(0,l.createElement)("p",{className:"text-xs text-gray-500"},"Belum ada data hotel"),u.map(e=>(0,l.createElement)("label",{key:e.id,className:"flex items-center space-x-2 text-sm cursor-pointer hover:bg-gray-50 p-1 rounded"},(0,l.createElement)("input",{type:"checkbox",checked:E.hotels.includes(parseInt(e.id)),onChange:()=>(e=>{const t=E.hotels,a=parseInt(e);t.includes(a)?h(e=>({...e,hotels:t.filter(e=>e!==a)})):h(e=>({...e,hotels:[...t,a]}))})(e.id),className:"rounded text-blue-600"}),(0,l.createElement)("span",null,e.name))))),(0,l.createElement)("div",null,(0,l.createElement)("div",{className:"flex justify-between items-center mb-2"},(0,l.createElement)("label",{className:"label"},"Varian Harga (Kamar)"),(0,l.createElement)("button",{type:"button",onClick:()=>{h(e=>({...e,pricing_variants:[...e.pricing_variants,{type:"",price:0,currency:"IDR"}]}))},className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded hover:bg-green-200"},"+ Tambah")),(0,l.createElement)("div",{className:"space-y-2"},E.pricing_variants.map((e,t)=>(0,l.createElement)("div",{key:t,className:"flex space-x-2 items-center"},(0,l.createElement)("input",{type:"text",placeholder:"Tipe (Quad/Double)",className:"w-1/3 border p-1 text-sm rounded",value:e.type,onChange:e=>v(t,"type",e.target.value),list:"roomTypes"}),(0,l.createElement)("input",{type:"number",placeholder:"Harga",className:"w-1/3 border p-1 text-sm rounded",value:e.price,onChange:e=>v(t,"price",e.target.value)}),(0,l.createElement)("select",{className:"w-20 border p-1 text-sm rounded",value:e.currency,onChange:e=>v(t,"currency",e.target.value)},(0,l.createElement)("option",{value:"IDR"},"IDR"),(0,l.createElement)("option",{value:"USD"},"USD")),(0,l.createElement)("button",{type:"button",onClick:()=>(e=>{const t=E.pricing_variants.filter((t,a)=>a!==e);h(e=>({...e,pricing_variants:t}))})(t),className:"text-red-500 hover:bg-red-50 p-1 rounded"},"Ã—")))),(0,l.createElement)("datalist",{id:"roomTypes"},(0,l.createElement)("option",{value:"Quad"}),(0,l.createElement)("option",{value:"Quint"}),(0,l.createElement)("option",{value:"Triple"}),(0,l.createElement)("option",{value:"Double"})),(0,l.createElement)("p",{className:"text-xs text-gray-500 mt-1"},"Pastikan nama tipe kamar unik (misal: Quad, Quint).")))),(0,l.createElement)("div",{className:"flex justify-end border-t pt-4 space-x-3"},(0,l.createElement)("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300"},"Batal"),(0,l.createElement)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},"Simpan Paket")))},Z=()=>{const{getPackages:e,deletePackage:t,loading:a}=g(),[r,n]=(0,l.useState)([]),[s,c]=(0,l.useState)(!1),[m,i]=(0,l.useState)(null);(0,l.useEffect)(()=>{o()},[]);const o=async()=>{try{const t=await e();n(t||[])}catch(e){console.error(e)}},d=()=>{c(!1),i(null)};return(0,l.createElement)("div",{className:"p-6"},(0,l.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,l.createElement)("h1",{className:"text-2xl font-bold text-gray-800"},"Manajemen Paket Umroh"),(0,l.createElement)("button",{onClick:()=>c(!0),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition shadow"},"+ Buat Paket Baru")),a?(0,l.createElement)(y,null):(0,l.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},0===r.length&&(0,l.createElement)("p",{className:"col-span-3 text-center text-gray-500 py-10"},"Belum ada paket dibuat."),r.map(e=>(0,l.createElement)("div",{key:e.id,className:"bg-white rounded-lg shadow hover:shadow-lg transition border border-gray-100 overflow-hidden"},(0,l.createElement)("div",{className:"bg-blue-50 p-4 border-b border-blue-100 flex justify-between items-start"},(0,l.createElement)("div",null,(0,l.createElement)("span",{className:"text-xs font-bold uppercase text-blue-600 tracking-wide"},e.category_name||"Umroh"),(0,l.createElement)("h3",{className:"text-lg font-bold text-gray-800 mt-1"},e.name)),(0,l.createElement)("span",{className:"px-2 py-1 rounded text-xs font-bold "+("active"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600")},"active"===e.status?"Open":e.status)),(0,l.createElement)("div",{className:"p-4 space-y-3"},(0,l.createElement)("div",{className:"flex items-center text-sm text-gray-600"},(0,l.createElement)("span",{className:"w-6 text-center mr-2"},"âœˆï¸"),(0,l.createElement)("span",null,e.departure_date," (Maskapai ID: ",e.airline_id,")")),(0,l.createElement)("div",{className:"flex items-center text-sm text-gray-600"},(0,l.createElement)("span",{className:"w-6 text-center mr-2"},"ðŸ¨"),(0,l.createElement)("span",null,Array.isArray(e.hotels)?e.hotels.length:0," Hotel Terpilih")),(0,l.createElement)("div",{className:"flex items-center text-sm text-gray-600"},(0,l.createElement)("span",{className:"w-6 text-center mr-2"},"ðŸ’°"),(0,l.createElement)("span",null,"Mulai ",(e=>{if(!e||0===e.length)return"-";const t=e.map(e=>parseFloat(e.price)),a=Math.min(...t);return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}).format(a)})(e.pricing_variants)))),(0,l.createElement)("div",{className:"bg-gray-50 p-3 flex justify-between border-t"},(0,l.createElement)("button",{onClick:()=>(e=>{i(e),c(!0)})(e),className:"text-blue-600 hover:text-blue-800 text-sm font-medium"},"Edit Detail"),(0,l.createElement)("button",{onClick:()=>(async e=>{if(confirm("Hapus paket ini? Data jamaah terkait mungkin akan error."))try{await t(e),o()}catch(e){alert("Gagal hapus: "+e.message)}})(e.id),className:"text-red-600 hover:text-red-800 text-sm font-medium"},"Hapus"))))),s&&(0,l.createElement)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4"},(0,l.createElement)("div",{className:"w-full max-w-4xl"},(0,l.createElement)(X,{initialData:m,onSuccess:()=>{d(),o()},onCancel:d}))))},ee=({initialData:e,closeModal:t})=>{const{createOrUpdate:a}=g(),[r,n]=(0,l.useState)(!1),[s,c]=(0,l.useState)({name:e?.name||"",phone:e?.phone||"",email:e?.email||"",address:e?.address||"",city:e?.city||"",status:e?.status||"active"}),m=e=>c({...s,[e.target.name]:e.target.value});return(0,l.createElement)("form",{onSubmit:async l=>{l.preventDefault(),n(!0);try{await a("sub_agents",s,e?.id),t()}catch(e){alert(e.message)}finally{n(!1)}},className:"space-y-4 p-2"},(0,l.createElement)(J,{label:"Nama Agen / Travel",name:"name",value:s.name,onChange:m,required:!0}),(0,l.createElement)("div",{className:"grid grid-cols-2 gap-4"},(0,l.createElement)(J,{label:"No. Telepon",name:"phone",value:s.phone,onChange:m,required:!0}),(0,l.createElement)(J,{label:"Email",type:"email",name:"email",value:s.email,onChange:m})),(0,l.createElement)("div",{className:"grid grid-cols-2 gap-4"},(0,l.createElement)(J,{label:"Kota Domisili",name:"city",value:s.city,onChange:m}),(0,l.createElement)(q,{label:"Status",name:"status",value:s.status,onChange:m},(0,l.createElement)("option",{value:"active"},"Aktif"),(0,l.createElement)("option",{value:"inactive"},"Tidak Aktif"))),(0,l.createElement)(J,{label:"Alamat Lengkap",name:"address",value:s.address,onChange:m}),(0,l.createElement)("div",{className:"flex justify-end gap-2 pt-4"},(0,l.createElement)(R,{type:"button",variant:"secondary",onClick:t},"Batal"),(0,l.createElement)(R,{type:"submit",disabled:r},r?"Menyimpan...":"Simpan")))},te=()=>{const{getSubAgents:e,apiCall:t}=g(),[a,r]=(0,l.useState)([]),[n,s]=(0,l.useState)(!1),[c,m]=(0,l.useState)(null),[i,o]=(0,l.useState)(!0),d=async()=>{o(!0);try{const a=await(e?e():t("/sub-agents"));r(Array.isArray(a)?a:a.data||[])}catch(e){console.error("Gagal memuat data agen:",e)}finally{o(!1)}};return(0,l.useEffect)(()=>{d()},[]),i?(0,l.createElement)(y,{text:"Memuat Data Agen..."}):(0,l.createElement)("div",{className:"p-6"},(0,l.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,l.createElement)("div",null,(0,l.createElement)("h1",{className:"text-2xl font-bold text-gray-800"},"Data Sub-Agen"),(0,l.createElement)("p",{className:"text-sm text-gray-500"},"Kelola mitra dan perwakilan agen travel.")),(0,l.createElement)("button",{onClick:()=>{m(null),s(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-sm transition"},(0,l.createElement)(A,null)," Tambah Agen")),(0,l.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},a.length>0?a.map(e=>(0,l.createElement)("div",{key:e.id,className:"bg-white rounded-xl p-5 shadow-sm border border-gray-100 hover:shadow-md transition"},(0,l.createElement)("div",{className:"flex items-start justify-between mb-4"},(0,l.createElement)("div",{className:"flex items-center gap-3"},(0,l.createElement)("div",{className:"w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center font-bold text-lg"},e.name?e.name.charAt(0).toUpperCase():"A"),(0,l.createElement)("div",null,(0,l.createElement)("h3",{className:"font-bold text-gray-800"},e.name),(0,l.createElement)("p",{className:"text-xs text-gray-500"},e.city||"Kota Tidak Diketahui"))),(0,l.createElement)("div",{className:"flex gap-1"},(0,l.createElement)("button",{onClick:()=>(e=>{m(e),s(!0)})(e),className:"p-1.5 text-gray-400 hover:text-blue-600 rounded hover:bg-blue-50"},(0,l.createElement)(M,null)),(0,l.createElement)("button",{onClick:()=>(async e=>{if(window.confirm("Hapus data agen ini?"))try{await t(`/sub-agents/${e}`,"DELETE"),d()}catch(e){alert("Gagal menghapus: "+e.message)}})(e.id),className:"p-1.5 text-gray-400 hover:text-red-600 rounded hover:bg-red-50"},(0,l.createElement)(K,null)))),(0,l.createElement)("div",{className:"space-y-2 text-sm text-gray-600 mb-4"},(0,l.createElement)("div",{className:"flex justify-between"},(0,l.createElement)("span",{className:"text-gray-400"},"Jamaah:"),(0,l.createElement)("span",{className:"font-medium"},e.jamaah_count||0," Orang")),(0,l.createElement)("div",{className:"flex justify-between"},(0,l.createElement)("span",{className:"text-gray-400"},"Komisi:"),(0,l.createElement)("span",{className:"font-medium text-green-600"},new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.commission||0)))),(0,l.createElement)("div",{className:"pt-3 border-t border-gray-50 flex gap-2"},(0,l.createElement)("a",{href:`https://wa.me/${e.phone}`,target:"_blank",rel:"noreferrer",className:"flex-1 bg-green-50 text-green-600 py-2 rounded-lg text-center text-sm font-medium hover:bg-green-100 flex items-center justify-center gap-2 transition"},(0,l.createElement)(D,null)," Hubungi")))):(0,l.createElement)("div",{className:"col-span-full text-center py-12 bg-white rounded-xl border border-dashed border-gray-300"},(0,l.createElement)("div",{className:"text-gray-400 text-4xl mb-3"},"ðŸ‘¥"),(0,l.createElement)("p",{className:"text-gray-500 font-medium"},"Belum ada data sub-agen."))),(0,l.createElement)(U,{isOpen:n,onClose:()=>s(!1),title:c?"Edit Sub Agen":"Tambah Sub Agen Baru",size:"md"},(0,l.createElement)(ee,{initialData:c,onSuccess:()=>{s(!1),d()},onCancel:()=>s(!1)})))},ae=()=>{const{getMasterData:e,createMasterData:t,deleteMasterData:a,getCategories:r,createCategory:n,deleteCategory:s,loading:c}=g(),[m,i]=(0,l.useState)("airline"),[o,d]=(0,l.useState)([]),[u,p]=(0,l.useState)(!1),[b,x]=(0,l.useState)({name:"",parent_id:0,details:""});(0,l.useEffect)(()=>{E()},[m]);const E=async()=>{try{let t;t="category"===m?await r():await e(m),d(t||[])}catch(e){console.error("Gagal ambil data",e)}},h="category"===m?o.filter(e=>0==e.parent_id):[];return(0,l.createElement)("div",{className:"p-6"},(0,l.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,l.createElement)("h1",{className:"text-2xl font-bold text-gray-800"},"Data Master"),(0,l.createElement)("button",{onClick:()=>p(!0),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition"},"+ Tambah Data")),(0,l.createElement)("div",{className:"flex space-x-4 border-b mb-6"},["airline","hotel","category"].map(e=>(0,l.createElement)("button",{key:e,onClick:()=>i(e),className:"pb-2 px-4 font-medium capitalize "+(m===e?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-gray-700")},"airline"===e?"Maskapai":"hotel"===e?"Hotel":"Kategori Paket"))),c?(0,l.createElement)(y,null):(0,l.createElement)("div",{className:"bg-white rounded-lg shadow overflow-hidden"},(0,l.createElement)("table",{className:"min-w-full divide-y divide-gray-200"},(0,l.createElement)("thead",{className:"bg-gray-50"},(0,l.createElement)("tr",null,(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Nama"),"category"===m&&(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Induk (Parent)"),"category"!==m&&(0,l.createElement)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Detail"),(0,l.createElement)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"Aksi"))),(0,l.createElement)("tbody",{className:"divide-y divide-gray-200"},0===o.length?(0,l.createElement)("tr",null,(0,l.createElement)("td",{colSpan:"4",className:"px-6 py-4 text-center text-gray-500"},"Belum ada data")):o.map(e=>(0,l.createElement)("tr",{key:e.id},(0,l.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},e.name),"category"===m&&(0,l.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},0!=e.parent_id?o.find(t=>t.id==e.parent_id)?.name||"-":(0,l.createElement)("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full"},"Utama")),"category"!==m&&(0,l.createElement)("td",{className:"px-6 py-4 text-sm text-gray-500 truncate max-w-xs"},"object"==typeof e.details?JSON.stringify(e.details):e.details||"-"),(0,l.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},(0,l.createElement)("button",{onClick:()=>(async e=>{if(confirm("Yakin hapus data ini?"))try{"category"===m?await s(e):await a(e),E()}catch(e){alert(e.message)}})(e.id),className:"text-red-600 hover:text-red-900"},"Hapus"))))))),(0,l.createElement)(U,{isOpen:u,onClose:()=>p(!1),title:`Tambah ${m}`},(0,l.createElement)("form",{onSubmit:async e=>{e.preventDefault();try{"category"===m?await n({name:b.name,parent_id:b.parent_id}):await t({name:b.name,type:m,details:b.details}),p(!1),x({name:"",parent_id:0,details:""}),E()}catch(e){alert(e.message)}},className:"space-y-4"},(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"block text-sm font-medium text-gray-700"},"Nama"),(0,l.createElement)("input",{type:"text",required:!0,value:b.name,onChange:e=>x({...b,name:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"})),"category"===m&&(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"block text-sm font-medium text-gray-700"},"Kategori Induk (Opsional)"),(0,l.createElement)("select",{value:b.parent_id,onChange:e=>x({...b,parent_id:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"},(0,l.createElement)("option",{value:"0"},"-- Tidak Ada (Kategori Utama) --"),h.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id},e.name))),(0,l.createElement)("p",{className:"text-xs text-gray-500 mt-1"},"Pilih jika ini adalah Sub-Kategori (misal: Awal Tahun)")),"category"!==m&&(0,l.createElement)("div",null,(0,l.createElement)("label",{className:"block text-sm font-medium text-gray-700"},"Detail Tambahan"),(0,l.createElement)("textarea",{value:b.details,onChange:e=>x({...b,details:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",rows:"3",placeholder:"Contoh: Lokasi hotel, Bintang 5, atau kode maskapai"})),(0,l.createElement)("div",{className:"flex justify-end pt-4"},(0,l.createElement)("button",{type:"button",onClick:()=>p(!1),className:"mr-2 px-4 py-2 text-gray-700 bg-gray-100 rounded hover:bg-gray-200"},"Batal"),(0,l.createElement)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},"Simpan")))))},le=()=>{const{currentUser:e}=u(),[t,a]=(0,l.useState)("dashboard"),r=[{id:"dashboard",label:"Dashboard",icon:(0,l.createElement)(z,null),roles:["owner","administrator","admin_staff","finance_staff","marketing_staff"]},{id:"packages",label:"Paket Umroh",icon:(0,l.createElement)(T,null),roles:["owner","administrator","admin_staff","marketing_staff"]},{id:"jamaah",label:"Data Jemaah",icon:(0,l.createElement)(H,null),roles:["owner","administrator","admin_staff","marketing_staff","finance_staff"]},{id:"finance",label:"Keuangan",icon:(0,l.createElement)(B,null),roles:["owner","administrator","finance_staff","admin_staff"]},{id:"marketing",label:"Marketing Leads",icon:(0,l.createElement)(L,null),roles:["owner","administrator","admin_staff","marketing_staff"]},{id:"sub_agents",label:"Sub Agen",icon:(0,l.createElement)(A,null),roles:["owner","administrator","admin_staff","marketing_staff"]},{id:"hr",label:"Manajemen HR",icon:(0,l.createElement)(H,null),roles:["owner","administrator"]},{id:"master",label:"Data Master",icon:(0,l.createElement)(O,null),roles:["owner","administrator","admin_staff"]}],n=e?.role||"";return(0,l.createElement)("div",{className:"flex h-screen bg-gray-100 font-sans"},(0,l.createElement)("aside",{className:"w-64 bg-white shadow-xl z-20 flex flex-col fixed h-full md:relative hidden md:flex"},(0,l.createElement)("div",{className:"p-6 border-b flex flex-col items-start"},(0,l.createElement)("h1",{className:"text-2xl font-extrabold text-blue-600 tracking-tight"},"UmrohMgr"),(0,l.createElement)("div",{className:"mt-4 w-full"},(0,l.createElement)("p",{className:"text-sm font-medium text-gray-900 truncate"},e?.full_name||"Pengguna"),(0,l.createElement)("span",{className:"mt-1 inline-block px-2 py-0.5 text-xs font-bold text-blue-800 bg-blue-100 rounded-full uppercase"},n.replace(/_/g," ")))),(0,l.createElement)("nav",{className:"flex-1 overflow-y-auto py-4 space-y-1"},r.map(e=>e.roles.includes(n)&&(0,l.createElement)("button",{key:e.id,onClick:()=>a(e.id),className:"w-full flex items-center px-6 py-3 text-sm font-medium transition-all duration-200 \n                                    "+(t===e.id?"bg-blue-50 text-blue-700 border-r-4 border-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900")},(0,l.createElement)("span",{className:"mr-3 text-lg "+(t===e.id?"text-blue-600":"text-gray-400")},e.icon),e.label))),(0,l.createElement)("div",{className:"p-4 border-t bg-gray-50"},(0,l.createElement)("p",{className:"text-xs text-center text-gray-400"},"Â© ",(new Date).getFullYear()," JF Banten v1.1"))),(0,l.createElement)("main",{className:"flex-1 overflow-y-auto bg-gray-50 w-full p-4 md:p-0"},(()=>{switch(t){case"dashboard":default:return(0,l.createElement)(h,null);case"packages":return(0,l.createElement)(Z,null);case"jamaah":return(0,l.createElement)(Y,null);case"finance":return(0,l.createElement)($,null);case"marketing":return(0,l.createElement)(G,null);case"sub_agents":return(0,l.createElement)(te,null);case"hr":return(0,l.createElement)(Q,null);case"master":return(0,l.createElement)(ae,null)}})()))},re=()=>(0,l.createElement)(d,null,(0,l.createElement)(b,null,(0,l.createElement)(le,null)));document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("umh-admin-app");e&&(0,n.H)(e).render((0,l.createElement)(r().StrictMode,null,(0,l.createElement)(re,null)))})})();